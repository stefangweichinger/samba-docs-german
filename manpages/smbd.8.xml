<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd" [
				  
<!ENTITY % globalentities SYSTEM '../entities/global.entities'> %globalentities;
]>
<refentry id="smbd.8">

<refmeta>
	<refentrytitle>smbd</refentrytitle>
	<manvolnum>8</manvolnum>
</refmeta>


<refnamediv>
	<refname>smbd</refname>
	<refpurpose>Server, der SMB/CIFS-Dienste für Clients anbietet</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis>
		<command>smbd</command>
		<arg choice="opt">-D</arg>
		<arg choice="opt">-F</arg>
		<arg choice="opt">-S</arg>
		<arg choice="opt">-i</arg>
		<arg choice="opt">-h</arg>
		<arg choice="opt">-V</arg>
		<arg choice="opt">-b</arg>
		<arg choice="opt">-d &lt;Debug-Ebene&gt;</arg>
		<arg choice="opt">-l &lt;Log-Verzeichnis&gt;</arg>
		<arg choice="opt">-p &lt;Port-Nummer(s)&gt;</arg>
		<arg choice="opt">-O &lt;Socket-Option&gt;</arg>
		<arg choice="opt">-s &lt;Konfig-Datei&gt;</arg>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
	<title>BESCHREIBUNG</title>

	<para>Dieses Werkzeug ist Teil der 
	<citerefentry><refentrytitle>Samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry>-Suite.</para>

	<para><command>smbd</command> ist der Server-Daemon, der Dateifreigaben 
	und Druckdienste für Windows-Clients bietet. Der Server bietet Raum für 
	Dateien und Druckerdienste für Clients mit Hilfe des Protokolls SMB 
	(oder CIFS). Dieses ist kompatibel mit dem LanManager-Protokoll und kann 
	LanManager-Clients bedienen. Dazu gehören MSCLIENT 3.0 für DOS, Windows 
	for Workgroups, Windows 95/98/ME, Windows NT, Windows 2000, OS/2, DAVE 
	für den Macintosh und smbfs für Linux.</para>

	<para>Eine umfangreiche Beschreibung der Dienste, die der Server anbietet,
	ist in der Manpage zur Konfigurationsdatei enthalten, in der die Attribute
	jener Dienste eingestellt werden (siehe 
	<citerefentry><refentrytitle>smb.conf</refentrytitle>
	<manvolnum>5</manvolnum></citerefentry>. Diese Manpage beschreibt nicht
	die Dienste, sondern konzentriert sich auf die administrativen Aspekte 
	des Serverbetriebs.</para>

	<para>Beachten Sie bitte, dass es beim Betrieb dieses Servers
	erhebliche Folgen für die Sicherheit gibt, und die Manpage zu
	<citerefentry><refentrytitle>smb.conf</refentrytitle>
	<manvolnum>5</manvolnum></citerefentry> sollte unbedingt gelesen 
	werden, bevor mit der Installation begonnen wird.</para>

	<para>Eine Sitzung wird immer dann erzeugt, wenn ein Client eine
	verlangt. Jeder Client erhält eine Kopie des Servers für jede 
	Sitzung. Diese Kopie bedient dann während der Sitzung alle 
	Verbindungen, die der Client herstellt. Wenn alle Verbindungen 
	ihres Clients geschlossen sind, terminiert die Kopie des Servers 
	für diesen Client.</para>

	<para>Die Konfigurationsdatei sowie alle Dateien, die sie lädt, 
	werden automatisch einmal pro Minute geladen, falls sie sich 
	verändern. Sie können ein erneutes Laden erzwingen, indem Sie ein
	SIGHUP an den Server senden. Das erneute Laden der Konfigurationsdatei 
	hat keinen Einfluss auf Verbindungen zu Diensten, die bereits  
	hergestellt sind. Der Benutzer muss sich entweder von dem Dienst 
	trennen oder <command>smbd</command> muss terminiert und neu gestartet
	werden.</para>
</refsect1>

<refsect1>
	<title>OPTIONEN</title>

	<variablelist>
		<varlistentry>
		<term>-D</term>
		<listitem><para>Falls angegeben bewirkt dieser Parameter, dass 
		der Server als Daemon arbeitet, d.h. er koppelt sich selbst ab, 
		und läuft im Hintergrund, wo er Anfragen an den entsprechenden 
		Port weiterleitet. Der Betrieb als Daemon ist die empfohlene 
		Art und Weise, <command>smbd</command> auf Servern zu betreiben,
		die öfter als nur gelegentlich Datei- und Druckdienste
		anbieten. Diese Option wird eingeschaltet, falls 
		<command>smbd</command> von der Kommandozeile einer Shell
		ausgeführt wird.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>-F</term>
		<listitem><para>Falls angegeben bewirkt dieser Parameter, dass
		der <command>smbd</command>-Hauptprozess nicht zum Daemon wird,
		d.h. sich doppelt teilt und vom Terminal abkoppelt.
		Kindprozesse werden weiterhin ganz normal erzeugt, um jede 
		Verbindungsanfrage zu bedienen, aber der Hauptprozess existiert
		nicht. Dieser Betriebsmodus eignet sich beim Einsatz von
		<command>smbd</command> unter Prozessüberwachungswerkzeugen wie
		<command>supervise</command> und <command>svscan</command>
		aus dem Paket <command>daemontools</command> von Daniel J. Bernstein, 
		oder dem AIX-Prozessmonitor.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>-S</term>
		<listitem><para>Falls angegeben bewirkt dieser Parameter, dass
		<command>smbd</command> als Log-Datei die Standardausgabe statt 
		einer anderen Datei verwendet.</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>-i</term>
		<listitem><para>Falls angegeben bewirkt dieser Parameter, dass
		der Server "interaktiv" läuft, also nicht als Daemon, selbst dann,
		wenn der Server von der Kommandozeile einer Shell ausgeführt wird. 
		Das Setzen dieses Parameters negiert den impliziten Deamon-Modus 
		bei der Ausführung von der Kommandozeile. <command>smbd</command> 
		schreibt seine Log-Daten ebenfalls auf die Standardausgabe, als ob
		der Parameter <command>-S</command> angegeben wäre.
		</para></listitem>
		</varlistentry>
		
		&popt.common.samba;
		&stdarg.help;

		<varlistentry>
		<term>-b</term>
		<listitem><para>Gibt Informationen darüber aus, wie  
		Samba kompiliert wurde.</para></listitem>
		</varlistentry>
		
		<varlistentry>
		<term>-p &lt;Port-Nummer(n)&gt;</term>
		<listitem><para><replaceable>Port-Nummer(n)</replaceable> ist eine 
		mit Leerzeichen oder Kommata getrennte Liste von TCP-Ports, die 
		smbd abhören soll. Der Vorgabewert dafür wird aus dem Parameter
		<smbconfoption><name>ports</name></smbconfoption> in &smb.conf;
		übernommen.</para>

		<para>Die Standard-Ports sind 139 (bei SMB über NetBIOS über TCP)
		und Port 445 (bei einfachem SMB über TCP).
	</para></listitem>
		
		</varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>DATEIEN</title>

	<variablelist>
		<varlistentry>
		<term><filename>/etc/inetd.conf</filename></term>
		<listitem><para>Falls der Server vom Meta-Daemon 
		<command>inetd</command> gestartet werden soll, muss diese 
		Datei die passende Startup-Information für den Meta-Daemon 
		enthalten. 
		</para></listitem>
		</varlistentry>
		
		<varlistentry>
		<term><filename>/etc/rc</filename></term>
		<listitem><para>(oder welches Initialisierungs-Skript Ihr 
		System benutzt.)</para>

		<para>Wenn der Server beim Hochfahren als Daemon gestartet wird, 
		muss diese Datei eine passende Startup-Sequenz für den Server
		enthalten.</para></listitem>
		</varlistentry>
		
		<varlistentry>
		<term><filename>/etc/services</filename></term>
		<listitem><para>Falls der Server vom Meta-Daemon 
		<command>inetd</command> betrieben wird, muss diese Datei 
		eine Abbildung von Dienstname (z.B. netbios-ssn) auf den 
		Dienst-Port (z.B. 139) und den Protokolltyp (z.B. tcp)
		enthalten.</para></listitem>
		</varlistentry>
		
		<varlistentry>
		<term><filename>/usr/local/samba/lib/smb.conf</filename></term>
		<listitem><para>Dies ist der vorgegebene Ort der Konfigurationsdatei
		<citerefentry><refentrytitle>smb.conf</refentrytitle>
		<manvolnum>5</manvolnum></citerefentry> des Servers. 
		Andere Orte, an denen verschiedene Systeme diese Datei 
		häufig installieren, sind 
		<filename>/usr/samba/lib/smb.conf</filename> 
		und <filename>/etc/samba/smb.conf</filename>.</para>
		
		<para>Diese Datei beschreibt alle Dienste, die der Server 
		den Clients zur Verfügung stellt. Siehe 
		<citerefentry><refentrytitle>smb.conf</refentrytitle>
		<manvolnum>5</manvolnum></citerefentry> für weitere 
		Informationen.</para>
		</listitem>
		</varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>BESCHRÄNKUNGEN</title>
	<para>Auf manchen Systemen kann <command>smbd</command> die uid nach 
	einem Aufruf von setuid() nicht wieder auf root zurücksetzen. Solche 
	Systeme werden auch "Trapdoor-uid"-Systeme genannt. Sollten Sie über
	ein solches System verfügen, können Sie von einem Client (z.B. einem PC) 
	nicht gleichzeitig Verbindungen unter zwei verschiedenen Benutzern
	herstellen. Beim Versuch, einen zweiten Benutzer zu verbinden, erhalten
	Sie Meldungen der Art Zugriff verweigert oder ähnlich.</para>
</refsect1>

<refsect1>
	<title>UMGEBUNGSVARIABLEN</title>

	<variablelist>
		<varlistentry>
		<term><envar>PRINTER</envar></term>
		<listitem><para>Wenn kein Druckername für irgendwelche Druckdienste 
		angegeben ist, verwenden die meisten Systeme den Wert dieser 
		Variablen (oder <constant>lp</constant>, falls diese Variable 
		nicht definiert ist) als Namen des Druckers. Das hängt jedoch 
		nicht vom Server ab.</para></listitem>
		</varlistentry>
	</variablelist>
</refsect1>


<refsect1>
        <title>PAM-INTERAKTION</title>
	<para>Samba verwendet PAM bei der Authentifikation (wenn es ein Passwort 
	in Klartext erhält), bei der Überprüfung von Konten (ist dieses Konto 
	deaktiviert?) sowie bei der Verwaltung von Sitzungen.
	Der Grad, bis zu dem PAM von Samba unterstützt wird, ist eingeschränkt 
	durch die Beschränkungen des SMB-Protokolls und den Parameter
	<smbconfoption><name>obey pam restrictions</name></smbconfoption>
	in <citerefentry><refentrytitle>smb.conf</refentrytitle>
	<manvolnum>5</manvolnum></citerefentry>. Wenn dieser gesetzt ist, gelten
	folgende Einschränkungen:
	</para>

	<itemizedlist>
	<listitem><para><emphasis>Konto-Validierung</emphasis>: Alle Zugriffe auf 
	einen Samba-Server werden mit PAM daraufhin überprüft, ob das Konto gültig
	ist, nicht deaktiviert ist und sich zu dem Zeitpunkt anmelden darf. 
	Das gilt auch für verschlüsselte Anmeldungen.
	</para></listitem>

	<listitem><para><emphasis>Sitzungs-Verwaltung</emphasis>: Wenn keine 
	Sicherheit auf der Ebene von Freigaben verwendet wird, müssen Benutzer 
	die Sitzungsüberprüfung durch PAM passieren, bevor der Zugriff erlaubt
	wird. Man beachte jedoch, dass dies bei der Sicherheit auf der Ebene 
	von Freigaben umgangen wird. Man beachte auch, dass manche älteren 
	PAM-Konfigurationsdateien eine zusätzliche Zeile für die Unterstützung 
	von Sitzungen benötigen. 
	</para></listitem>
	</itemizedlist>
</refsect1>

<refsect1>
	<title>VERSION</title>

	<para>Diese manpage ist korrekt für die Version 3.0 der 
	Samba Suite.</para>
</refsect1>

<refsect1>
	<title>DIAGNOSEMELDUNGEN</title>

	<para>Die meisten vom Server ausgegebenen Diagnosemeldungen werden in
	einer bestimmten Log-Datei gespeichert. Der Name der Log-Datei wird
	zum Zeitpunkt des Kompilierens angegeben, kann aber auf der 
	Kommandozeile überschrieben werden.</para>

	<para>Die Anzahl und Art der verfügbaren Diagnosemeldungen hängt von 
	der Debug-Ebene ab, die der Server benutzt. Wenn Sie Probleme haben, 
	setzen Sie die Debug-Ebene auf 3 und schauen Sie die Log-Dateien 
	durch.</para>

	<para>Die meisten Meldungen sind einigermaßen selbsterklärend. Als diese
	manpage erzeugt wurde, gab es leider zu viele Diagnosemeldungen im 
	Quellcode, als dass jede einzelne beschrieben werden konnte. Zu diesem
	Zeitpunkt ist das Beste, was Sie machen können, ein grep auf dem 
	Quellcode und zu versuchen, die Bedingungen herauszufinden, die zu der 
	Diagnosemeldung geführt haben, die Sie sehen.</para>
</refsect1>

<refsect1>
	<title>SIGNALE</title>

	<para>Ein SIGHUP an <command>smbd</command> zu senden, bewirkt, dass er 
	seine Konfigurationsdatei <filename>smb.conf</filename> innerhalb kurzer
	Zeit erneut lädt.</para>

	<para>Zum Herunterfahren eines <command>smbd</command>-Prozesses eines 
	Benutzers, wird empfohlen <command>SIGKILL (-9)</command> 
	<emphasis>NICHT</emphasis> zu benutzen, außer als letztes Mittel, weil
	das den Shared Memory-bereich in einen inkonsistenten Zustand versetzen 
	kann. Die sichere Art, einen <command>smbd</command> zu terminieren, 
	besteht darin, ihm das Signal SIGTERM (-15) zu schicken und darauf zu 
	warten, dass er sich selbst beendet.</para>

	<para>Die Debug-Log-Ebene von <command>smbd</command> kann mit Hilfe des
	Programms <citerefentry><refentrytitle>smbcontrol</refentrytitle>
	<manvolnum>1</manvolnum></citerefentry> erhöht oder erniedrigt werden 
	(SIGUSR[1|2]-Signale werden seit Samba 2.2 nicht mehr verwendet). 
	Das geschieht, damit vorübergehende Probleme diagnostiziert werden können,
	während man sich weiterhin auf einer normalerweise geringeren Log-Ebene 
	befindet.</para>

	<para>Beachten Sie, dass die Signal-Handler beim Schreiben in eine 
	Debug-Datei nicht re-entrant in <command>smbd</command> sind. Das heisst,
	Sie sollten warten, bis <command>smbd</command> wieder in einem Zustand ist,
	in dem es auf einen eintreffenden SMB wartet, bevor Sie solche abschicken.  
	Man kann Signal-Handler sicher machen, indem die Signale vor dem ausgewählten
	Aufrud entsperrt und hinterher wieder gesperrt werden, was aber die 
	Performanz beeinträchtigen würde.</para>
</refsect1>

<refsect1>
	<title>SIEHE AUCH</title>
	<para><citerefentry><refentrytitle>hosts_access</refentrytitle>
	<manvolnum>5</manvolnum></citerefentry>, <citerefentry><refentrytitle>inetd</refentrytitle>
	<manvolnum>8</manvolnum></citerefentry>, <citerefentry><refentrytitle>nmbd</refentrytitle>
	<manvolnum>8</manvolnum></citerefentry>, <citerefentry><refentrytitle>smb.conf</refentrytitle>
	<manvolnum>5</manvolnum></citerefentry>, <citerefentry><refentrytitle>smbclient</refentrytitle>
	<manvolnum>1</manvolnum></citerefentry>, <citerefentry><refentrytitle>testparm</refentrytitle>
	<manvolnum>1</manvolnum></citerefentry>, <citerefentry><refentrytitle>testprns</refentrytitle>
	<manvolnum>1</manvolnum></citerefentry> sowie die 
	Internet RFCs <filename>rfc1001.txt</filename> und <filename>rfc1002.txt</filename>. 
	Außerdem ist die CIFS- (früher SMB-) Spezifikation als Link auf der 
	Webseite <ulink noescape="1" url="http://samba.org/cifs/"> 
	http://samba.org/cifs/</ulink> verfügbar.</para>
</refsect1>

<refsect1>
	<title>AUTOR</title>
	
	<para>Die originale Samba-Software und die zugehörigen Werkzeuge
	wurden von Andrew Tridgell geschrieben. Samba wird nun vom 
	Samba-Team als ein Open-Source-Projekt entwickelt, ähnlich wie 
	der Linux-Kernel.</para>

	<para>Die originalen Samba-manpages wurden von Karl Auer geschrieben.
	Die manpage-Quelltexte wurden ins YODL-Format konvertiert (ein weiteres 
	exzellentes Stück Open Source Software, verfügbar unter <ulink
	url="ftp://ftp.icce.rug.nl/pub/unix/">ftp://ftp.icce.rug.nl/pub/unix/</ulink>)
	und für die Samba 2.0 Release von Jeremy Allison aktualisiert. Die 
	Umwandlung ins DocBook-Format wurde von Gerald Carter für Samba 2.2 
	durchgeführt. Die Umwandlung in DocBook für XML 4.2 wurde von Alexander 
	Bokovoy für Samba 3.0 durchgeführt.</para>
</refsect1>

</refentry>

<?xml version="1.0" encoding="ISO-8859-1"?>
<chapter id="NetworkBrowsing">
<chapterinfo>
	&author.jht;
	&author.jelmer;
	<author>&person.klimklim;<contrib>Deutsche Übersetzung</contrib></author>
	<author>&author.sgw;<contrib>Deutsche Übersetzung</contrib></author>
</chapterinfo>

<title>Netzwerk-Browsing</title>

<para>
Diese Dokumentation enthält detaillierte Informationen und einen Leitfaden, wie
man das Browsing über mehrere Subnetze und/oder Arbeitsgruppen (oder Domänen)
implementiert. WINS ist das beste Werkzeug, um NetBIOS-Namen auf IP-Adressen aufzulösen.
WINS ist nicht am Umgang mit Browse-Lists beteiligt, außer bei der Auflösung von Namen auf Adressen.
</para>

<note><para>
MS Windows 2000 und neuere Windows-Versionen können so konfiguriert werden, dass sie ohne NetBIOS über
TCP/IP arbeiten, wozu Samba ab Version 3 ebenfalls in der Lage ist. Ist
die Benutzung von NetBIOS über TCP/IP deaktiviert, werden die MS Windows Maschinen
über DNS und Active Directory aufgelöst. Die folgenden Informationen gehen davon aus,
dass ein Netz mit NetBIOS über TCP/IP betrieben wird. 
</para></note>

<sect1>
<title>Planung und Beginn</title>

<para>
Jemand bezog sich einst auf die Vergangenheit mit den Worten <quote><emphasis>Es war die beste
aller Zeiten, es war die schlechteste aller Zeiten.</emphasis></quote> Je mehr wir zurück blicken,
umso mehr sehnen wir uns nach dem, was war, und hoffen, dass es nie wiederkehrt.
</para>


<para>
<indexterm><primary>NetBIOS</primary></indexterm>
Für viele MS Windows Netzwerk-Administratoren beschreibt diese Aussage präzise deren
Gefühle bezüglich NetBIOS. Diejenigen, die NetBIOS gemeistert haben, wussten was sie erwartet.
Für diejenigen, die es nie geschafft haben, seine Eigenschaften zu zähmen, erscheint NetBIOS
wie Pattersons Fluch.
</para>

<para>
Für diejenigen, die nicht mit den botanischen Problemen Australiens vertraut sind:
Pattersons Fluch, <emphasis>Echium plantagineum</emphasis>, wurde Mitte des 19.
Jahrhunderts eingeführt. Seitdem hat es sich schnell ausgebreitet. Die hohe Samenproduktion
der Pflanze, mit einer Dichte von tausenden pro Quadratmeter, einer Lebensdauer von mehr
als sieben Jahren, der Fähigkeit, unter guten Voraussetzungen, über das ganze Jahr hinweg
zu keimen, sind einige der Eigenschaften, die es zu einem solch hartnäckigen Unkraut
machen. (Frank Patterson war einer der gefürchtesten Gesetzlosen Australiens. Nachdem
er wegen eines Diebstahls von vier Dollar am Galgen landete, verfluchte er die Stadt
Ironbark und die australische Regierung. Seine Familie pflanzte eine lilafarbene,
aus England stammende Pflanze auf sein Grab, die sich rasch im ganzen Land ausbreitete.
Aufgrund der Giftigkeit der Planze kostet ihre Vernichtung die Viehzüchter Australiens
ca. 30 Mill. Dollar pro Jahr, Anm. d. Übersetzers.)
</para>

<para>
In diesem Kapitel erfahren wir die grundlegenden Aspekte der Server Message Block- (SMB)
Vernetzung mit einem besonderen Blick auf SMB als Implementation in einer NetBIOS-über-TCP/IP-
(Network Basic Input/Output System) Umgebung. Da Samba SMB oder NetBIOS nicht
über ein anderes Protokoll implementiert, ist es wichtig zu wissen, wie man die
Netzwerkumgebung konfiguriert und sich schlicht daran zu erinnern, nichts anderes als TCP/IP auf 
allen MS Windows Clients im Netzwerk zu benutzen.
</para>

<para>
Samba bietet die Möglichkeit, WINS (Windows Inter-networking Name Server) samt der 
Systemerweiterungen von Microsofts WINS zu implementieren. Diese Systemerweiterungen
helfen Samba dabei, stabile WINS Operationen, über den herkömmlichen Anwendungsbereich von
MS WINS hinaus, zu ermöglichen.
</para>

<para>
WINS wirkt sich ausschließlich auf Systeme aus, die mit NetBIOS-über-TCP/IP laufen.
MS Windows 200x/XP können NetBIOS abschalten, in welchem Fall WINS keine Rolle mehr
spielt. Samba unterstützt dies ebenfalls.
</para>

<para>
In Netzwerken, in denen NetBIOS deaktiviert ist, d.h. wo WINS nicht mehr benötigt 
wird, ist der Einsatz eines DNS für die Namensauflösung unabdingbar.
</para>

</sect1>

<sect1>
<title>Was ist Browsing?</title>

<para>
Für die meisten ist Browsing, daß sie die MS Windows und Samba Server in der
Netzwerkumgebung sehen können, und daß, wenn man auf das Icon eines bestimmten
Servers klickt, ein Fenster geöffnet wird, in dem man die verfügbaren Freigaben und
Drucker des Servers sehen kann.
</para>

<para>
Was so einfach klingt, ist in Wirklichkeit eine komplexe Interaktion verschiedener
Technologien. Die dabei involvierten Technologien (oder Methoden) beinhalten:
</para>

<itemizedlist>
	<listitem>MS Windows Maschinen melden ihre Präsenz im Netzwerk an.</listitem>
	<listitem>Maschinen kündigen sich anderen Maschinen im Netzwerk an.</listitem>
	<listitem>Eine oder mehrere Maschinen fassen diese Ankündigungen lokal zusammen.</listitem>
	<listitem>Der Client findet die Maschine, die diese Liste von Maschinen gesammelt hat.</listitem>
	<listitem>Der Client ist in der Lage, den Namen der Maschine in eine IP-Adresse aufzulösen.</listitem>
	<listitem>Der Client ist in der Lage, sich mit einer anderen Maschine zu verbinden.</listitem>
</itemizedlist>

<para>
Die Samba-Anwendung, die die Verwaltung des Browsing und die Namensauflösung kontrolliert, heißt
<filename>nmbd</filename>. Die dabei verwendeten Konfigurationsparameter sind:
</para>

<para>Browsing-Optionen: <smbconfoption><name>os level</name></smbconfoption>(*),
	<smbconfoption><name>lm announce</name></smbconfoption>,
	<smbconfoption><name>lm interval</name></smbconfoption>,
	<smbconfoption><name>preferred master</name></smbconfoption>(*),
	<smbconfoption><name>local master</name></smbconfoption>(*),
	<smbconfoption><name>domain master</name></smbconfoption>(*),
	<smbconfoption><name>browse list</name></smbconfoption>,
	<smbconfoption><name>enhanced browsing</name></smbconfoption>.
</para>

<para>Namensauflösungs-Methoden:
	<smbconfoption><name>name resolve order</name></smbconfoption>(*).
</para>

<para>WINS-Optionen:
	<smbconfoption><name>dns proxy</name></smbconfoption>,
	<smbconfoption><name>wins proxy</name></smbconfoption>,
	<smbconfoption><name>wins server</name></smbconfoption>(*),
	<smbconfoption><name>wins support</name></smbconfoption>(*),
	<smbconfoption><name>wins hook</name></smbconfoption>.
</para>

<para>
<indexterm><primary>WINS</primary></indexterm>
Für Samba sind der WINS-Server und die WINS-Unterstützung zwei einander ausschließende Optionen. Die mit
(*) markierten Optionen sind die einzigen Optionen, die im Allgemeinen verändert werden müssen. Sogar wenn
keiner dieser Parameter gesetzt ist, tut <filename>nmbd</filename> nach wir vor seinen Job.
</para>

</sect1>

<sect1 id="netdiscuss">
<title>Diskussion</title>

<para>
Die gesamte MS Windows-Netzwerk-Technologie verwendet <quote>SMB Messaging</quote>. Dieses kann mit oder ohne
NetBIOS implementiert werden. MS Windows 200x unterstützt NetBIOS-über-TCP/IP, für Rückwärtskompatibilität.
MS scheint zu planen, NetBIOS-Unterstützung auslaufen zu lassen.
</para>

<sect2>
<title>NetBIOS-über-TCP/IP</title>

<para>
Samba implementiert NetBIOS, wie es auch MS Windows NT/200x/XP tut, indem es dieses Protokoll in
TCP/IP einbettet. NetBIOS-basierendes Netzwerke verwenden Broadcasts, um die Verwaltung der Browselists zu
regeln. Wenn man NetBIOS-über-TCP/IP ausführt, verwendet dieses UDP-Messaging, diese UDP-Nachrichten können
broadcast oder uni-cast sein.
</para>


<para>
<indexterm><primary>UDP</primary></indexterm>
Normalerweise können nur uni-cast UDP-Messages von Routern weitergeleitet werden. Der Parameter
<smbconfoption><name>remote announce</name></smbconfoption> in &smb.conf; hilft dabei, die Ankündigungen und
Aktualisierungen der Browselists in entfernte Netzwerksegmente über uni-cast UDP weiterzugeben. In ähnlicher
Weise implementiert der Parameter <smbconfoption><name>remote browse sync</name></smbconfoption> in &smb.conf;
die Sammlung und Zusammenfügung von Browselists mittels uni-cast UDP.
</para>

<para>
Weiters sollte <filename>nmbd</filename> in jenen Netzen, in denen Samba die einzige SMB-Server-Technologie ist,
wo immer es möglich ist, auf einer Maschine als der WINS-Server konfiguriert werden. Das macht es einfach, die
Browsing-Umgebung zu verwalten. Wenn jedes Netzwerk-Segment mit seinem eigenen Samba-WINS-Server konfiguriert 
ist, dann ist der einzige Weg, um Browsing über mehrere Segmente zu ermöglichen, die Verwendung der Parameter
<indexterm><primary>LMB</primary><see>Local Master Browser</see></indexterm>
<indexterm><primary>Local Master Browser</primary></indexterm>
<smbconfoption><name>remote announce</name></smbconfoption> und 
<smbconfoption><name>remote browse sync</name></smbconfoption> in Ihrer &smb.conf;.
</para>

<para>
<indexterm><primary>WINS</primary></indexterm>
Wenn nur ein WINS-Server für ein gesamtes Multi-Segment-Netzwerk verwendet wird, dann sollte die Verwendung
der Parameter <smbconfoption><name>remote announce</name></smbconfoption> und
<smbconfoption><name>remote browse sync</name></smbconfoption> nicht erforderlich sein.
</para>

<para>
<indexterm><primary>Replikation</primary><secondary>WINS</secondary></indexterm>
Seit Samba-3 wird an der Replikation von WINS gearbeitet. Der Großteil des Codes wurde bereits ins Samba-SVN
übernommen, muß aber noch <quote>reifen</quote>. Diese Replikation ist kein unterstütztes Feature der
Samba-3.0.0-Release. Hoffentlich wird es zu einem unterstützten Feature in einer der folgenden Samba-3-Releases. 
</para>

<para>
Derzeit unterstützt das Samba WINS keine MS-WINS-Replikation. Das bedeutet, daß, wenn Sie einen Samba-Server als
WINS-Server einrichten, nur <emphasis>ein</emphasis> <filename>nmbd</filename> als WINS-Server im Netzwerk 
konfiguriert sein darf. Manche Installationen haben mehrere Samba-WINS-Server aus Gründen der Redundanz 
eingesetzt (ein Server pro Subnetz) und dann <smbconfoption><name>remote announce</name></smbconfoption> und
<smbconfoption><name>remote browse sync</name></smbconfoption> verwendet, um die Sammlung und Zusammenführung
der Browselists über alle Segmente zu erzielen. Beachten Sie, daß dies bedeutet, daß Clients nur lokale Namen
auflösen, und so konfiguriert werden müssen, daß sie DNS zur Auflösung von Namen anderer Subnetze verwenden,
um es ihnen zu ermöglichen, die IP-Adressen der Server anderer Subnetze aufzulösen. Dieses Setup wird nicht
empfohlen, aber wird aus Gründen der Vollständigkeit, und aus praktischen Überlegungen aufgeführt
(d.h. als Szenario, <quote>wenn alles andere schiefgeht</quote>).
</para>

<para>
Zuletzt beachten Sie noch, daß Browselists eine Sammlung von unzuverlässigen Broadcast-Nachrichten sind, die in
Intervallen von nicht mehr als 15 Minuten wiederholt werden. Das bedeutet, daß es Zeit braucht, eine Browselist
zu bilden, und es bis zu 45 Minuten dauern kann, bis diese sich stabilisiert, speziell über verschiedene
Netzwerk-Segmente hinweg.
</para>

</sect2>

<sect2>
<title>TCP/IP ohne NetBIOS</title>

<para>
<indexterm><primary>NetBIOS</primary></indexterm>
<indexterm><primary>NetBIOS-frei</primary></indexterm>
<indexterm><primary>DNS</primary></indexterm>
Alle TCP/IP-fähigen Systeme verwenden verschiedene Formen der Namensauflösung. Die primären Methoden für
TCP/IP-Namensauflösung inkludieren entweder eine statische Datei (<filename>/etc/hosts</filename>) oder
DNS (Domain Name System). DNS ist die Technologie, die das Internet benutzbar macht. DNS-basierende
Namensauflösung wird von fast allen TCP/IP-fähigen Systemen unterstützt, nur ein paar wenige 
<quote>embedded</quote> TCP/IP-Systeme unterstützen kein DNS.
</para>

<para>
Wenn ein MS Windows 200x/XP-System versucht, einen Hostnamen zu einer IP-Adresse aufzulösen, folgt es einem
definierten Pfad:
</para>

<orderedlist>
	<listitem><para>
	Prüfung der Datei <filename>hosts</filename>. Diese befindet sich in
	<filename>C:\Windows NT\System32\Drivers\etc</filename>.
	</para></listitem>

	<listitem><para>
	Ausführung einer DNS-Abfrage.
	</para></listitem>

        <listitem><para>
	Prüfung des NetBIOS-Namens-Cache.
        </para></listitem>

        <listitem><para>
	Abfrage des WINS-Server.
        </para></listitem>

        <listitem><para>
	Ausführung einer Broadcast-Abfrage über UDP.
        </para></listitem>

        <listitem><para>
	Überprüfung der Datei LMHOSTS, in
        <filename>C:\Windows NT\System32\Drivers\etc</filename>.
        </para></listitem>
</orderedlist>


<para>
<indexterm><primary>DNS</primary></indexterm>
Windows 200x/XP kann seinen Hostnamen an einem <quote>Dynamic DNS Server</quote> registrieren. Sie können dies
erzwingen:
<command>ipconfig /registerdns</command>.
</para>

<para>
Mit Active Directory (ADS) ist ein korrekt funktionierender DNS-Server essentiell notwendig.
Beim Fehlen eines korrekt funktionierenden und arbeitenden DNS-Servers sind die MS Windows Clients und Server
nicht mehr imstande, einander gegenseitig zu finden, daher werden in Folge auch die Netzwerkdienste ernsthaft
geschädigt.
</para>

<para>
Die Verwendung von <quote>Dynamic DNS</quote> wird mit Active Directory wärmstens empfohlen,
wo auch der Einsatz von BIND9 vorzuziehen ist (wegen seiner Fähigkeit zur adäquaten Unterstützung der 
SRV-Einträge, die für Active Directory benötigt werden).
</para>

</sect2>

<sect2 id="adsdnstech">
<title>DNS und Active Directory</title>


<para>
<indexterm><primary>DNS</primary><secondary>Active Directory</secondary></indexterm>
Fallweise hören wir von UNIX-Netzwerk-Administratoren, die einen UNIX-basierenden Dynamic-DNS-Server
anstatt des MS-DNS-Servers einsetzen wollen. Während dies für manche wünschenswert seín mag, der
MS Windows 200x DNS Server ist für die Zusammenarbeit mit Active Directory automatisch vorkonfiguriert. Es
ist möglich, BIND in der Version 8 oder 9 einzusetzen, aber es wird fast mit Sicherheit notwendig sein,
SRV-Einträge anzulegen, damit MS Active Directory Clients Hostnamen auflösen können, um essentielle
Netzwerkdienste lokalisieren können. Im Folgenden einige der Standard-SRV-Einträge, die Active Directory
benötigt:
</para>

<variablelist>
<varlistentry>
	<term>_ldap._tcp.pdc._msdcs.<emphasis>Domain</emphasis></term>
	<listitem>
	<para>
	Gibt die Adresse des Windows NT PDC für die Domäne an.
	</para>
	</listitem>
</varlistentry>
<varlistentry>
	<term>_ldap._tcp.pdc._msdcs.<emphasis>DomainTree</emphasis></term>
	<listitem>
        <para>
	Löst die Adressen der <quote>Global Catalog Server</quote> in der Domäne auf.
        </para>
	</listitem>
</varlistentry>
<varlistentry>
        <term>_ldap._tcp.<emphasis>site</emphasis>.sites.writable._msdcs.<emphasis>Domain</emphasis></term>
	<listitem>
        <para>
	Gibt eine Liste der Domänen-Controller an, basierend auf den Sites.
        </para>
	</listitem>
</varlistentry>
<varlistentry>
        <term>_ldap._tcp.writable._msdcs.<emphasis>Domain</emphasis></term>
	<listitem>
        <para>
	Listet Domänen-Controller auf, die eine schreibberechtigte Kopie des Active Directory führen.
        </para>
	</listitem>
</varlistentry>
<varlistentry>
	<term>_ldap._tcp.<emphasis>GUID</emphasis>.domains._msdcs.<emphasis>DomainTree</emphasis></term>
	<listitem>
	<para>
	Eintrag, der von MS Windows Clients verwendet wird, um Maschinen mittels des 
	<quote>Global Unique Identifier</quote> zu lokalisieren.
	</para>
	</listitem>
</varlistentry>
<varlistentry>
	<term>_ldap._tcp.<emphasis>Site</emphasis>.gc._msdcs.<emphasis>DomainTree</emphasis></term>
	<listitem>
	<para>
	Verwendet von MS Windows Clients, um den <quote>Global Catalog server</quote> zu lokalisieren,
 	der abhängig von der Site-Konfiguration ist.
	</para>
	</listitem>
</varlistentry>
</variablelist>

	<para>
	Spezifische Einträge, die von MS Windows Clients verwendet werden, um essentielle Dienste für eine
	Beispiel-Domäne namens <constant>quenya.org</constant> zu lokalisieren, beinhalten:
	</para>

	<itemizedlist>
		<listitem><para>
		_kerberos._udp.quenya.org &smbmdash; Verwendet, um den KDC-Server über UDP zu kontaktieren.
		Dieser Eintrag muß für jeden KDC den Port 88 auflisten.
		</para></listitem>

		<listitem><para>
		_kpasswd._udp.quenya.org &smbmdash; Verwendet, um den <constant>kpasswd</constant>-Server
		zu lokalisieren, wenn die Änderung eines Benutzerpassworts bearbeitet werden soll. Dieser
		Eintrag muß den Port 464 auf dem Master-KDC auflisten.
		</para></listitem>

		<listitem><para>
		_kerberos._tcp.quenya.org &smbmdash; Verwendet, um den KDC-Server via TCP zu lokalisieren.
		Dieser Eintrag muß für jeden KDC den Port 88 auflisten.
		</para></listitem>

		<listitem><para>
		_ldap._tcp.quenya.org &smbmdash; Verwendet, um den LDAP-Dienst auf dem PDC zu lokalisieren.
		Dieser Eintrag muß den Port 389 des PDCs enthalten.		
		</para></listitem>

		<listitem><para>
		_kpasswd._tcp.quenya.org &smbmdash; Verwendet, um den <constant>kpasswd</constant>-Server
                zu lokalisieren, um Änderungen von Benutzerpasswörtern zu erlauben. Dieser Eintrag muß den Port
		464 enthalten.
		</para></listitem>

		<listitem><para>
		_gc._tcp.quenya.org &smbmdash; Verwendet, um den <quote>Global Catalog server</quote> für
		die Domäne zu lokalisieren. Dieser Eintrag muß den Port 3268 auflisten.
		</para></listitem>
	</itemizedlist>
	
	<para>
	Die folgenden Einträge werden auch vom Windows Domain Member Client verwendet, um wichtige Dienste
	auf den Windows ADS Domänen-Controllern zu finden.
	</para>

	<itemizedlist>
		<listitem><para>
		_ldap._tcp.pdc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_ldap.gc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_ldap.default-first-site-name._sites.gc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_ldap.{SecID}.domains._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_ldap._tcp.dc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_kerberos._tcp.dc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_ldap.default-first-site-name._sites.dc._msdcs.quenya.org
		</para></listitem>

		<listitem><para>
		_kerberos.default-first-site-name._sites.dc._msdcs.queyna.org
		</para></listitem>

		<listitem><para>
		SecID._msdcs.quenya.org
		</para></listitem>
	</itemizedlist>

	<para>
	Das Vorhandensein der korrekten DNS-Einträge kann so validiert werden:
<screen>
&rootprompt; dig @frodo -t any _ldap._tcp.dc._msdcs.quenya.org

; &lt;lt;&gt;&gt; DiG 9.2.2 &lt;lt;&gt;&gt; @frodo -t any _ldap._tcp.dc._msdcs.quenya.org
;; global options:  printcmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 3072
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 2


;; QUESTION SECTION:
;_ldap._tcp.dc._msdcs.quenya.org. IN        ANY


;; ANSWER SECTION:
_ldap._tcp.dc._msdcs.quenya.org. 600 IN SRV 0 100 389 frodo.quenya.org.
_ldap._tcp.dc._msdcs.quenya.org. 600 IN SRV 0 100 389 noldor.quenya.org.


;; ADDITIONAL SECTION:
frodo.quenya.org. 3600  IN      A       10.1.1.16
noldor.quenya.org. 1200  IN      A       10.1.1.17


;; Query time: 0 msec
;; SERVER: frodo#53(10.1.1.16)
;; WHEN: Wed Oct  7 14:39:31 2004
;; MSG SIZE  rcvd: 171
</screen>
	</para>

</sect2>

</sect1>

<sect1>
<title>Wie Browsing funktioniert</title>

<para>
MS Windows Maschinen registrieren ihre NetBIOS-Namen (d.h. den Maschinen-Namen für jeden laufenden Dienst)
beim Start. Die genaue Methode, in der diese Registrierung stattfindet, ist davon abhängig, ob der
MS Windows Client/Server eine WINS-Server-Adresse erhalten hat oder nicht, ob die LMHOSTS-Abfrage aktiviert ist,
ob DNS für die Auflösung von NetBIOS-Namen aktiviert ist, etc.
</para>

<para>
In dem Fall, wo es keinen WINS-Server gibt, werden alle Namensregistrierungen wie auch Namensabfragen mittels
UDP-Broadcasts durchgeführt. Dies beschränkt die Namensauflösung auf das lokale Subnetz, außer LMHOSTS wird
zur Listung aller Namen und IP-Adressen verwendet. In solchen Situationen bietet Samba eine Möglichkeit, mit
der der Samba-Server zwangsweise in die Browselist eines fernen MS Windows Netzwerks eingetragen werden kann
(mittels des Parameters <smbconfoption><name>remote announce</name></smbconfoption>).
</para>

<para>
Wo ein WINS-Server eingesetzt wird, wird der MS Windows Client UDP uni-cast verwenden, um sich am WINS-Server
zu registrieren. Solche Pakete können geroutet werden und daher erlaubt WINS Namensauflösung über geroutete
Netzwerke.
</para>

<para>
Während des Startvorgangs wird eine Wahl stattfinden, um einen <quote>Local Master Browser</quote> zu bestimmen,
wenn nicht bereits ein solcher existiert. In jedem NetBIOS-Netzwerk wird eine Maschine erwählt, um als
der <quote>Domain Master Browser</quote> zu fungieren. Dieses Domänen-Browsing hat nichts mit 
MS Domänen-Controlling zu tun. Stattdessen übernimmt der Domain Master Browser die Rolle, jeden
LMB (<quote>Local Master Browser</quote>) zu kontaktieren (entweder über WINS oder LMHOSTS ausfindig gemacht),
und die Browselists auszutauschen. Auf diese Weise erhält jeder Master Browser eine komplette Liste aller
Maschinen im Netzwerk. Alle 11 bis 15 Minuten wird eine Wahl abgehalten, um zu bestimmen, welche Maschine der
Master Browser sein soll. Nach den Kriterien dieser Wahl wird die Maschine mit der größten Uptime, der
höchsten Protokoll-Version oder anderen Kriterien die Wahl zum <quote>Domain Master Browser</quote> gewinnen.
</para>

<para>
Clients, die das Netzwerk durchsuchen wollen, verwenden diese Liste, aber sind auch abhängig von korrekter
Namensauflösung auf die entsprechenden IP-Adresse(n).
</para>

<para>
Jede Konfiguration, die die Namensauflösung und/oder die Browsing-Funktionalitäten verletzt, wird die Benutzer
verärgern, da sie dann immer wieder damit konfrontiert sind, die Netzwerkdienste nicht verwenden zu können.
</para>

<para>
Samba unterstützt ein Feature, das die erzwungene Synchronisation von Browselists über geroutete Netzwerke
mittels des Parameters <smbconfoption><name>remote browse sync</name></smbconfoption> in der Datei
&smb.conf; erlaubt. Dies veranlasst Samba, den LMB in einem fernen Netzwerk zu kontaktieren, und dort die
Synchronisation der Browselists zu erfragen. Dies überbrückt effektiv zwei durch Router getrennte Netzwerke.
Die beiden entfernten Netzwerke können entweder Broadcast-basierende oder WINS-basierende Namensauflösung
verwenden, aber es sollte beachtet werden, daß der Parameter 
<smbconfoption><name>remote browse sync</name></smbconfoption> Browselist-Synchronisation anbietet, und diese
ist etwas anderes als Namensauflösung. In anderen Worten, um <quote>Cross-Subnetz-Browsing</quote> korrekt
arbeiten zu lassen, ist es essentiell, daß ein Mechanismus zur Auflösung von Namen auf Adressen vorhanden ist.
Dieser Mechanismus kann via DNS, <filename>/etc/hosts</filename>, usw. funktionieren.
</para>

<sect2 id="DMB">
<title>Konfiguration von ARBEITSGRUPPEN-Browsing</title>

<para>
Um <quote>Cross-Subnetz-Browsing</quote> in einem Netzwerk zu konfigurieren, das Maschinen in einer
ARBEITSGRUPPE enthält, nicht solche einer NT Domäne, müssen Sie einen Samba-Server als Domänen Master Browser
(DMB) einrichten (beachten Sie, daß dies nicht dasselbe wie ein Primär-Domänen-Controller ist, obwohl in einer
NT Domäne dieselbe Maschine beide Funktionen übernimmt). Die Rolle eines Domänen Master Browsers ist das
Sammeln und Zusammenfügen der Browselists von den Lokalen Master Browsern all der Subnetze, die eine Maschine
beinhalten, die Teil der Arbeitsgruppe ist. Ohne daß eine Maschine als Domänen Master Browser konfiguriert ist,
würde jedes Subnetz eine isolierte Arbeitsgruppe sein, die unfähig wäre, irgendwelche Maschinen in einem anderen
Subnetz zu sehen. Es ist das Vorhandensein eines Domänen Master Browsers, der Cross-Subnetz-Browsing für eine
Arbeitsgruppe ermöglicht. 
</para>

<para>
In einer ARBEITSGRUPPEN-Umgebung muß der Domänen Master Browser ein Samba-Server sein, und es darf nur einen
DMB pro Arbeitsgruppen-Namen geben. Um einen Samba-Server als DMB einzurichten, setzen Sie folgende Option
im Abschnitt <smbconfsection>[global]</smbconfsection> der Datei &smb.conf;:
</para>

<para>
<smbconfblock>
<smbconfoption><name>domain master</name><value>yes</value></smbconfoption>
</smbconfblock>
</para>

<para>
Der Domänen Master Browser sollte vorzugsweise auch der Lokale Master Browser für sein eigenes Subnetz sein.
Um dies zu erreichen, setzen Sie die Optionen im Abschnitt <smbconfsection>[global]</smbconfsection>
der Datei &smb.conf; wie <link linkend="dmbexample">im folgenden Beispiel</link>:
</para>

<para>
<smbconfexample id="dmbexample">
<title>smb.conf für einen Domänen Master Browser</title>
<smbconfsection>[global]</smbconfsection>
<smbconfoption><name>domain master</name><value>yes</value></smbconfoption>
<smbconfoption><name>local master</name><value>yes</value></smbconfoption>
<smbconfoption><name>preferred master</name><value>yes</value></smbconfoption>
<smbconfoption><name>os level</name><value>65</value></smbconfoption>
</smbconfexample>
</para>

<para>
Der Domänen Master Browser kann dieselbe Maschine wie der WINS-Server sein, wenn notwendig.
</para>

<para>
Als Nächstes sollten Sie sicherstellen, daß jedes der Subnetze eine Maschine enthält, die als der Lokale Master 
Browser für die Arbeitsgruppe arbeiten kann. Jede MS Windows NT/200x/XP-Maschine sollte imstande sein, dies zu 
tun, genauso wie Windows 9x/Me-Maschinen (obwohl diese dazu neigen, öfters neu gestartet zu werden, also ist es
keine allzu gute Idee, diese dafür zu verwenden). Um einen Samba-Server zu einem Lokalen Master Browser zu 
machen, setzen Sie die Optionen im Abschnitt <smbconfsection>[global]</smbconfsection>
der Datei &smb.conf; wie <link linkend="lmbexample">im folgenden Beispiel</link>:
</para>

<para>
<smbconfexample id="lmbexample">
<title>smb.conf für einen Lokalen Master Browser</title>
<smbconfsection>[global]</smbconfsection>
<smbconfoption><name>domain master</name><value>no</value></smbconfoption>
<smbconfoption><name>local master</name><value>yes</value></smbconfoption>
<smbconfoption><name>preferred master</name><value>yes</value></smbconfoption>
<smbconfoption><name>os level</name><value>65</value></smbconfoption>
</smbconfexample>
</para>

<para>
Machen Sie das nicht für mehr als einen Samba-Server pro Subnetz, oder diese Rechner werden gegeneinander darum
kämpfen, welcher denn der Lokale Master Browser sein soll.
</para>

<para>
Der Parameter <smbconfoption><name>local master</name></smbconfoption> erlaubt es Samba, als Lokaler Master 
Browser zu arbeiten. Der Parameter <smbconfoption><name>preferred master</name></smbconfoption> veranlaßt
<command>nmbd</command> dazu, bei seinem Start eine Browser-Wahl zu erzwingen, und 
<smbconfoption><name>os level</name></smbconfoption> stuft Samba so hoch ein, daß es jede Wahl gewinnen sollte.
</para>

<para>
Wenn Sie eine NT-Maschine im Subnetz haben, die Sie zum Lokalen Master Browser machen wollen, können Sie Samba
<quote>verbieten</quote>, ein Lokaler Master Browser zu werden, indem Sie folgende Optionen im Abschnitt 
<smbconfsection>[global]</smbconfsection>
der Datei &smb.conf; wie <link linkend="nombexample">im folgenden Beispiel</link> setzen:
</para>

<para>
<smbconfexample id="nombexample">
<title>smb.conf für Samba-Server, der nicht Master Browser ist</title>
<smbconfsection>[global]</smbconfsection>
<smbconfoption><name>domain master</name><value>no</value></smbconfoption>
<smbconfoption><name>local master</name><value>no</value></smbconfoption>
<smbconfoption><name>preferred master</name><value>no</value></smbconfoption>
<smbconfoption><name>os level</name><value>0</value></smbconfoption>
</smbconfexample>
</para>

</sect2>

<sect2>
<title>Konfiguration von DOMÄNEN-Browsing</title>

<para>
Wenn Sie Samba-Server einer Windows-NT-Domäne hinzufügen, dann dürfen Sie keinen Samba-Server als Domänen Master
Browser einrichten. Standardmässig ist der Windows NT-PDC einer Domäne auch gleichzeitig der Domänen Master
Browser für diese Domäne. Das Netzwerk-Browsing kann zusammenbrechen, wenn sich ein Samba-Server mit dem
NetBIOS-Namen des Domänen Master Browsers am WINS-Server anmeldet (<replaceable>DOMÄNE</replaceable>&lt;1B&gt;),
zusätzlich zum PDC.
</para>

<para>
Für andere Subnetze als jenes, das den Windows NT PDC enthält, können Sie wie beschrieben Samba-Server als
Lokale Master Browser einrichten. Um einen Samba-Server zu einem Lokalen Master Browser zu machen, setzen Sie
folgende Optionen im Abschnitt <smbconfsection>[global]</smbconfsection>
der Datei &smb.conf; wie <link linkend="remsmb">im folgenden Beispiel</link>:
</para>

<para>
<smbconfexample id="remsmb">
<title>smb.conf für einen Lokalen Master Browser</title>
<smbconfsection>[global]</smbconfsection>
<smbconfoption><name>domain master</name><value>no</value></smbconfoption>
<smbconfoption><name>local master</name><value>yes</value></smbconfoption>
<smbconfoption><name>preferred master</name><value>yes</value></smbconfoption>
<smbconfoption><name>os level</name><value>65</value></smbconfoption>
</smbconfexample>
</para>

<para>
Wenn Sie wollen, daß ein Samba-Server mit anderen Maschinen im Subnetz um den Sieg in der Browsing-Wahl kämpft,
können Sie den Parameter <smbconfoption><name>os level</name></smbconfoption> auf niedrigere Werte setzen. Damit 
können Sie die Reihenfolge feintunen, in der die Maschinen zum Lokalen Master Browser werden, wenn sie laufen.
Mehr Details dazu im Abschnitt 
<link linkend="browse-force-master">Wie man Samba dazu zwingt, der Master zu sein</link>.
</para>

<para>
Wenn Sie Windows NT Maschinen haben, die Domänenmitglieder auf allen Subnetzen sind, und Sie sind sich sicher, 
daß diese Maschinen immer laufen werden, können Sie Samba von der Teilnahme an Browsing-Wahlen ausnehmen, und
damit deaktivieren, daß Samba jemals ein Lokaler Master Browser wird, indem Sie folgende Optionen im 
Abschnitt <smbconfsection>[global]</smbconfsection>
der Datei &smb.conf; wie <link linkend="xremmb">im folgenden Beispiel</link> setzen:
</para>

<para>
<smbconfexample id="xremmb">
<title>&smb.conf; für Samba-Server, der nie Master Browser wird</title>
<smbconfsection>[global]</smbconfsection>
<smbconfoption><name>domain master</name><value>no</value></smbconfoption>
<smbconfoption><name>local master</name><value>no</value></smbconfoption>
<smbconfoption><name>preferred master</name><value>no</value></smbconfoption>
<smbconfoption><name>os level</name><value>0</value></smbconfoption>
</smbconfexample>
</para>

</sect2>

<sect2 id="browse-force-master">
<title>Wie man Samba dazu zwingt, der Master zu sein</title>

<para>
Wer der Master Browser wird, hängt von einem Wahlvorgang ab, der Broadcasts verwendet. Jedes Wahl-Paket enthält
eine Anzahl von Parametern, die bestimmen, welchen Rang ein Host in der Wahl einnimmt. Per Standard verwendet
Samba einen niedrigen Rang und verliert daher die Wahlen gegen so gut wie jeden Windows-Netzwerk-Client oder
-Server.
</para>

<para>
Wenn Sie wollen, daß Samba Wahlen gewinnt, setzen Sie die globale Option 
<smbconfoption><name>os level</name></smbconfoption> in &smb.conf; auf einen höheren Wert. Der Standard ist 20.
Die Verwendung von 34 liesse Samba alle Wahlen gegen jedes andere System gewinnen (außer gegen andere 
Samba-Systeme).
</para>

<para>
Ein <smbconfoption><name>os level</name></smbconfoption> von 2 würde es Windows for Workgroups und Windows 9x/Me
schlagen lassen, aber nicht MS Windows NT/200x Server. Ein MS Windows NT/200x Server Domänen Controller verwendet
level 32. Das Maximum für <smbconfoption><name>os level</name></smbconfoption> ist 255.
</para>

<para>
Wenn Sie wollen, daß Samba bei seinem Start eine Wahl erzwingt, setzen Sie die globale Option
<smbconfoption><name>preferred master</name></smbconfoption> in &smb.conf; auf <constant>yes</constant>.
Samba hat dann einen leichten Vorteil gegnüber anderen potentiellen Master Browsern, die keine
<quote>Preferred Master Browser</quote> sind. Verwenden Sie diesen Parameter vorsichtig, denn wenn Sie zwei
Hosts (egal ob diese Windows 9x/Me oder NT/200x/XP oder Samba ausführen) im selben Subnetz habe, die
<smbconfoption><name>preferred master</name></smbconfoption> auf <constant>yes</constant> gesetzt haben, werden
diese beiden periodisch und kontinuierlich eine Wahl erzwingen, um Lokaler Master Browser zu werden.
</para>

<para>
Wenn Sie wollen, daß Samba ein <emphasis>Domänen Master Browser</emphasis> wird, dann ist es zu empfehlen,
daß Sie auch <smbconfoption><name>preferred master</name></smbconfoption> auf <constant>yes</constant> setzen,
da Samba nicht zum Domänen Master Browser für Ihr gesamtes LAN oder WAN wird, wenn er nicht auch ein Lokaler
Master Browser in seinem eigenen Broadcast-isolierten Subnetz ist. 
</para>

<para>
Es ist möglich, zwei Samba-Server so zu konfigurieren, daß sie versuchen, Domänen Master Browser für eine Domäne
zu werden. Der erste Server, der startet, wird der Domänen Master Browser. Alle anderen Samba-Server werden alle
fünf Minuten versuchen, zum Domänen Master Browser zu werden. Sie werden herausfinden, daß ein anderer 
Samba-Server bereits der Domänen Master Browser ist und scheitern. Dies gewährt automatisch Redundanz, wenn der
aktuelle Domänen Master Browser ausfallen sollte.
</para>

</sect2>

<sect2>
<title>Wie man Samba zum Domänen Master macht</title>

<para>
Der Domänen Master ist verantwortlich für die Sammlung und Zusammenführung der Browselists von
mehreren Subnetzen, sodaß Browsing über Subnetze hinweg stattfinden kann. Sie können Samba zum Domänen Master
machen, indem Sie in der Datei &smb.conf; den Parameter 
<smbconfoption><name>domain master</name><value>yes</value></smbconfoption> setzen. In der Voreinstellung ist
Samba kein Domänen Master.
</para>

<para>
Setzen Sie Samba nicht auf Domänen Master für eine Arbeitsgruppe, die denselben Namen wie eine
NT/200x Domäne hat. Wenn Samba als Domänen Master für eine Arbeitsgruppe konfiguriert ist, die sich im selben 
Subnetz wie
eine gleichnamige Windows NT/200x Domäne befindet, werden mit Sicherheit Browsing-Probleme auftreten.
</para>

<para>
Wenn Samba Domänen Master und Master Browser ist, wird es auf Master-Verlautbarungen (die ca. alle 12 Minuten
stattfinden) von Lokalen Master Browsern in anderen Subnetzen hören, und diese dann kontaktieren, um die
Browselists zu synchronisieren.
</para>

<para>
Wenn Sie wollen daß Samba der Domänen Master ist, sollten Sie auch den Wert für
<smbconfoption><name>os level</name></smbconfoption> ausreichend hoch setzen, um sicherzustellen, daß Samba
Browsing-Wahlen gewinnt, und <smbconfoption><name>preferred master</name></smbconfoption> auf
<constant>yes</constant>, um beim Start von Samba eine solche Wahl zu erzwingen.
</para>

<para>
Alle Server (inklusive Samba) und Clients sollten einen WINS-Server zur NetBIOS-Namensauflösung verwenden. Wenn
Ihre Clients nur Broadcasting zur NetBIOS-Namensauflösung verwenden, werden zwei Dinge geschehen:
</para>

<orderedlist>
<listitem>
	<para>
	Die Lokalen Master Browser werden nicht mehr imstande sein, einen Domänen Master Browser zu finden, da
	sie nur noch im lokalen Subnetz suchen können.
	</para>
</listitem>

<listitem>
	<para>
	Wenn ein Client doch eine domänen-weite Browselist erhascht, und ein Benutzer versucht, auf einen Host in
	dieser Liste zuzugreifen, wird er nicht imstande sein, den NetBIOS-Namen dieses Hosts aufzulösen.
	</para>
</listitem>
</orderedlist>

<para>
Wenn jedoch sowohl Samba als auch Ihre Clients einen WINS-Server verwenden, dann:
</para>

<orderedlist>
<listitem>
	<para>
	Lokale Master Browser kontaktieren den WINS-Server, und, sofern Samba sich als Domänen Master Browser
	am WINS-Server registriert hat, der Lokale Master Browser empfängt die IP-Adresse des Samba-Servers
	als die seines Domänen Master Browsers.
	</para>
</listitem>

<listitem>
	<para>
	Wenn ein Client eine domänen-weite Browselist erhält, und ein Benutzer versucht, auf einen Host in
        dieser Liste zuzugreifen, kontaktiert der Client den WINS-Server, um den NetBIOS-Namen dieses Hosts
	aufzulösen. Sofern dieser Host seinen eigenen NetBIOS-Namen am selben WINS-Server registriert hat, wird
	der Benutzer diesen Host auch sehen können.	
	</para>
</listitem>
</orderedlist>

</sect2>

<sect2>
<title>Bemerkung zu Broadcast-Adressen</title>

<para>
Wenn Ihr Netzwerk eine auf 0 basierende Broadcast-Adresse verwendet (zum Beispiel, wenn diese auf 0 endet), dann
werden Sie Probleme bekommen. Windows for Workgroups scheint keine 0-Broadcasts zu unterstützen, und Sie werden
wahrscheinlich herausfinden, daß Browsing und Namensauflösung nicht funktionieren.
</para>
</sect2>

<sect2>
<title>Mehrere Interfaces</title>

<para>
Samba unterstützt Maschinen mit mehreren Netzwerk-Interfaces. Wenn Sie mehrere Interfaces haben, müssen Sie die
Option <smbconfoption><name>interfaces</name></smbconfoption> in &smb.conf; setzen, um sie zu konfigurieren.
</para>
</sect2>
<sect2>
<title>Verwendung des Parameters Remote Announce</title>
<para>
Der Parameter <smbconfoption><name>remote announce</name></smbconfoption> in &smb.conf; kann dazu verwendet
werden, zu erzwingen, daß all die NetBIOS-Namen eines Netzwerks in einem entfernten Netzwerk bekanntgegeben
werden. Die Syntax des Parameters <smbconfoption><name>remote announce</name></smbconfoption> ist:
<smbconfblock>
<smbconfoption><name>remote announce</name><value>a.b.c.d [e.f.g.h] ...</value></smbconfoption>
</smbconfblock>
<emphasis>or</emphasis>
<smbconfblock>
<smbconfoption><name>remote announce</name><value>a.b.c.d/ARBEITSGRUPPE [e.f.g.h/ARBEITSGRUPPE] ...</value></smbconfoption>
</smbconfblock>

wobei:
<variablelist>
	<varlistentry><term><replaceable>a.b.c.d</replaceable> und <replaceable>e.f.g.h</replaceable></term>
		<listitem><para>
<indexterm><primary>LMB</primary><see>Local Master Browser</see></indexterm>
<indexterm><primary>Local Master Browser</primary></indexterm>
		entweder die IP-Adresse des LMB (Lokaler Master Browser) ist oder die Broadcast-Adresse des
		entfernten Netzwerks, d.h. der LMB ist unter 192.168.1.10 erreichbar, oder die Adresse wird
		als 192.168.1.255 angegeben, wobei ein 24-Bit-Netzwerk angenommen wird (255.255.255.0).
		Wenn die Bekanntgabe an die Broadcast-Adresse des entfernten Netzwerks erfolgt, wird jeder
		Host diese empfangen. Das macht ziemlich viel <quote>Lärm</quote> im Netz, und daher nicht
		erstrebenswert, kann aber erforderlich sein, wenn wir die IP-Adresse des entfernten LMBs nicht
		kennen.
		</para></listitem>
	</varlistentry>

	<varlistentry>
		<term><replaceable>WORKGROUP</replaceable></term>
		<listitem><para>is optional and can be either our own workgroup or that of the remote network. If you use the
		workgroup name of the remote network, our NetBIOS machine names will end up looking like
		they belong to that workgroup. This may cause name resolution problems and should be avoided.
		</para></listitem>
	</varlistentry>
</variablelist>
</para>

</sect2>

<sect2>
<title>Use of the Remote Browse Sync Parameter</title>

<para>
The <smbconfoption><name>remote browse sync</name></smbconfoption> parameter of 
&smb.conf; is used to announce to another LMB that it must synchronize its NetBIOS name list with our
Samba LMB. This works only if the Samba server that has this option is
simultaneously the LMB on its network segment.
</para>

<para>
The syntax of the <smbconfoption><name>remote browse sync</name></smbconfoption> parameter is:

<smbconfblock>
<smbconfoption><name>remote browse sync</name><value><replaceable>a.b.c.d</replaceable></value></smbconfoption>
</smbconfblock>

where <replaceable>a.b.c.d</replaceable> is either the IP address of the
remote LMB or else is the network broadcast address of the remote segment.
</para>

</sect2>

</sect1>

<sect1>
<title>WINS &smbmdash; The Windows Inter-networking Name Server</title>

<para>
Use of WINS (either Samba WINS or MS Windows NT Server WINS) is highly
recommended. Every NetBIOS machine registers its name together with a
name_type value for each of several types of service it has available.
It registers its name directly as a unique (the type 0x03) name.
It also registers its name if it is running the LanManager compatible
server service (used to make shares and printers available to other users)
by registering the server (the type 0x20) name.
</para>

<para>
All NetBIOS names are up to 15 characters in length. The name_type variable
is added to the end of the name, thus creating a 16 character name. Any
name that is shorter than 15 characters is padded with spaces to the 15th
character. Thus, all NetBIOS names are 16 characters long (including the
name_type information).
</para>

<para>
WINS can store these 16-character names as they get registered. A client
that wants to log onto the network can ask the WINS server for a list
of all names that have registered the NetLogon service name_type. This saves
broadcast traffic and greatly expedites logon processing. Since broadcast
name resolution cannot be used across network segments this type of
information can only be provided via WINS or via a statically configured
<filename>lmhosts</filename> file that must reside on all clients in the
absence of WINS.
</para>

<para>
WINS also serves the purpose of forcing browse list synchronization by all
LMBs. LMBs must synchronize their browse list with the DMB (Domain Master
Browser) and WINS helps the LMB to identify its DMB. By definition this
will work only within a single workgroup. Note that the Domain Master Browser
has nothing to do with what is referred to as an MS Windows NT Domain. The
later is a reference to a security environment while the DMB refers to the
master controller for browse list information only.
</para>

<para>
WINS will work correctly only if every client TCP/IP protocol stack
has been configured to use the WINS servers. Any client that has not been
configured to use the WINS server will continue to use only broadcast-based
name registration so WINS may never get to know about it. In any case,
machines that have not registered with a WINS server will fail name to address
lookup attempts by other clients and will therefore cause workstation access
errors.
</para>

<para>
To configure Samba as a WINS server just add 
<smbconfoption><name>wins support</name><value>yes</value></smbconfoption> to the &smb.conf;
file [global] section.
</para>

<para>
To configure Samba to register with a WINS server just add
<smbconfoption><name>wins server</name><value>a.b.c.d</value></smbconfoption>
to your &smb.conf; file <smbconfsection>[global]</smbconfsection> section.
</para>

<important><para>
Never use both <smbconfoption><name>wins support</name><value>yes</value></smbconfoption> together
with <smbconfoption><name>wins server</name><value>a.b.c.d</value></smbconfoption>
particularly not using its own IP address. Specifying both will cause &nmbd; to refuse to start!
</para></important>

<sect2>
<title>WINS Server Configuration</title>

<para>
Either a Samba Server or a Windows NT Server machine may be set up
as a WINS server. To configure a Samba Server to be a WINS server you must
add to the &smb.conf; file on the selected Server the following line to
the <smbconfsection>[global]</smbconfsection> section:
</para>

<para>
<smbconfblock>
<smbconfoption><name>wins support</name><value>yes</value></smbconfoption>
</smbconfblock>
</para>

<para>
Versions of Samba prior to 1.9.17 had this parameter default to
yes. If you have any older versions of Samba on your network it is
strongly suggested you upgrade to a recent version, or at the very
least set the parameter to <quote>no</quote> on all these machines.
</para>

<para>
Machines configured with <smbconfoption><name>wins support</name><value>yes</value></smbconfoption> will keep a list of 
all NetBIOS names registered with them, acting as a DNS for NetBIOS names.
</para>

<para>
It is strongly recommended to set up only one WINS server. Do not set the
<smbconfoption><name>wins support</name><value>yes</value></smbconfoption> option on more than one Samba 
server.
</para>

<para>
<indexterm><primary>replication</primary><secondary>WINS</secondary></indexterm>
To configure Windows NT/200x Server as a WINS server, install and configure
the WINS service. See the Windows NT/200x documentation for details.
Windows NT/200x WINS servers can replicate to each other, allowing more
than one to be set up in a complex subnet environment. As Microsoft
refuses to document the replication protocols, Samba cannot currently
participate in these replications. It is possible in the future that
a Samba-to-Samba WINS replication protocol may be defined, in which
case more than one Samba machine could be set up as a WINS server.
Currently only one Samba server should have the 
<smbconfoption><name>wins support</name><value>yes</value></smbconfoption> parameter set.
</para>

<para>
After the WINS server has been configured, you must ensure that all
machines participating on the network are configured with the address
of this WINS server. If your WINS server is a Samba machine, fill in
the Samba machine IP address in the <guilabel>Primary WINS Server</guilabel> field of
the <guilabel>Control Panel->Network->Protocols->TCP->WINS Server</guilabel> dialogs
in Windows 9x/Me or Windows NT/200x. To tell a Samba server the IP address
of the WINS server, add the following line to the <smbconfsection>[global]</smbconfsection> section of
all &smb.conf; files:
</para>

<para>
<smbconfblock>
<smbconfoption><name>wins server</name><value>&lt;name or IP address&gt;</value></smbconfoption>
</smbconfblock>
</para>

<para>
where &lt;name or IP address&gt; is either the DNS name of the WINS server
machine or its IP address.
</para>

<para>
This line must not be set in the &smb.conf; file of the Samba
server acting as the WINS server itself. If you set both the
<smbconfoption><name>wins support</name><value>yes</value></smbconfoption> option and the 
<smbconfoption><name>wins server</name><value>&lt;name&gt;</value></smbconfoption> option then
<command>nmbd</command> will fail to start.
</para>

<para>
There are two possible scenarios for setting up cross-subnet browsing.
The first details setting up cross-subnet browsing on a network containing
Windows 9x/Me, Samba and Windows NT/200x machines that are not configured as
part of a Windows NT Domain. The second details setting up cross-subnet
browsing on networks that contain NT Domains.
</para>

</sect2>

<sect2>
<title>WINS Replication</title>

<para>
<indexterm><primary>replication</primary><secondary>WINS</secondary></indexterm>
Samba-3 permits WINS replication through the use of the <filename>wrepld</filename> utility.
This tool is not currently capable of being used as it is still in active development.
As soon as this tool becomes moderately functional, we will prepare man pages and enhance this
section of the documentation to provide usage and technical details.
</para>

</sect2>
<sect2>
<title>Static WINS Entries</title>

<para>
Adding static entries to your Samba WINS server is actually fairly easy.
All you have to do is add a line to <filename>wins.dat</filename>, typically
located in <filename class="directory">/usr/local/samba/var/locks</filename> or
<filename>/var/run/samba</filename>.
</para>

<para>
Entries in <filename>wins.dat</filename> take the form of:

<programlisting>
"NAME#TYPE" TTL ADDRESS+ FLAGS
</programlisting>

where NAME is the NetBIOS name, TYPE is the NetBIOS type, TTL is the
time-to-live as an absolute time in seconds, ADDRESS+ is one or more
addresses corresponding to the registration and FLAGS are the NetBIOS
flags for the registration.
</para>

<para>
A typical dynamic entry looks like this:
<programlisting>
"MADMAN#03" 1055298378 192.168.1.2 66R
</programlisting>

To make it static, all that has to be done is set the TTL to 0, like this:

<programlisting>
"MADMAN#03" 0 192.168.1.2 66R
</programlisting>
</para>

<para>
Though this method works with early Samba-3 versions, there is a
possibility that it may change in future versions if WINS replication
is added.
</para>

</sect2>
</sect1>

<sect1>
<title>Helpful Hints</title>

<para>
The following hints should be carefully considered as they are stumbling points
for many new network administrators.
</para>

<sect2>
<title>Windows Networking Protocols</title>

<para>
A common cause of browsing problems results from installing more than
one protocol on an MS Windows machine.
</para>

<warning><para>
Do not use more than one protocol on MS Windows clients.
</para></warning>

<para>
Every NetBIOS machine takes part in a process of electing the LMB (and DMB)
every 15 minutes. A set of election criteria is used to determine the order
of precedence for winning this election process. A machine running Samba or
Windows NT will be biased so the most suitable machine will predictably
win and thus retain its role.
</para>

<para>
The election process is <quote>fought out</quote> so to speak over every NetBIOS network
interface. In the case of a Windows 9x/Me machine that has both TCP/IP and IPX
installed and has NetBIOS enabled over both protocols, the election will be
decided over both protocols. As often happens, if the Windows 9x/Me machine is
the only one with both protocols then the LMB may be won on the NetBIOS
interface over the IPX protocol. Samba will then lose the LMB role as Windows
9x/Me will insist it knows who the LMB is. Samba will then cease to function
as an LMB and thus browse list operation on all TCP/IP-only machines will
fail.
</para>

<para>
Windows 95, 98, 98se, and Me are referred to generically as Windows 9x/Me.
The Windows NT4, 200x, and XP use common protocols. These are roughly
referred to as the Windows NT family, but it should be recognized that 2000 and
XP/2003 introduce new protocol extensions that cause them to behave 
differently from MS Windows NT4. Generally, where a server does not support
the newer or extended protocol, these will fall back to the NT4 protocols.
</para>

<para>
The safest rule of all to follow is: use only one protocol!
</para>

</sect2>

<sect2>
<title>Name Resolution Order</title>

<para>
Resolution of NetBIOS names to IP addresses can take place using a number
of methods. The only ones that can provide NetBIOS name_type information
are:
</para>

<itemizedlist>
	<listitem>WINS &smbmdash; the best tool.</listitem>
	<listitem>LMHOSTS &smbmdash; static and hard to maintain.</listitem>
	<listitem>Broadcast &smbmdash; uses UDP and cannot resolve names across remote segments.</listitem>
</itemizedlist>

<para>
Alternative means of name resolution include:
</para>
<itemizedlist>
<listitem>Static <filename>/etc/hosts</filename> &smbmdash;  hard to maintain, and lacks name_type info.</listitem>
<listitem>DNS &smbmdash; is a good choice but lacks essential name_type info.</listitem>
</itemizedlist>

<para>
Many sites want to restrict DNS lookups and avoid broadcast name
resolution traffic. The <parameter>name resolve order</parameter> parameter is of great help here.
The syntax of the <parameter>name resolve order</parameter> parameter is:
<smbconfblock>
<smbconfoption><name>name resolve order</name><value>wins lmhosts bcast host</value></smbconfoption>
</smbconfblock>
<emphasis>or</emphasis>
<smbconfblock>
<smbconfoption><name>name resolve order</name><value>wins lmhosts  	(eliminates bcast and host)</value></smbconfoption>
</smbconfblock>
The default is:
<smbconfblock>
<smbconfoption><name>name resolve order</name><value>host lmhost wins bcast</value></smbconfoption>
</smbconfblock>
where <quote>host</quote> refers to the native methods used by the UNIX system
to implement the gethostbyname() function call. This is normally
controlled by <filename>/etc/host.conf</filename>, <filename>/etc/nsswitch.conf</filename> and <filename>/etc/resolv.conf</filename>.
</para>
</sect2>
</sect1>

<sect1>
<title>Technical Overview of Browsing</title>

<para>
SMB networking provides a mechanism by which clients can access a list
of machines in a network, a so-called <smbconfoption><name>browse list</name></smbconfoption>. This list
contains machines that are ready to offer file and/or print services
to other machines within the network. Thus it does not include
machines that aren't currently able to do server tasks. The browse
list is heavily used by all SMB clients. Configuration of SMB
browsing has been problematic for some Samba users, hence this
document.
</para>

<para>
MS Windows 2000 and later versions, as with Samba-3 and later versions, can be
configured to not use NetBIOS over TCP/IP. When configured this way,
it is imperative that name resolution (using DNS/LDAP/ADS) be correctly
configured and operative. Browsing will not work if name resolution
from SMB machine names to IP addresses does not function correctly.
</para>

<para>
Where NetBIOS over TCP/IP is enabled, use of a WINS server is highly
recommended to aid the resolution of NetBIOS (SMB) names to IP addresses.
WINS allows remote segment clients to obtain NetBIOS name_type information
that cannot be provided by any other means of name resolution.
</para>

<sect2>
<title>Browsing Support in Samba</title>

<para>
Samba facilitates browsing. The browsing is supported by &nmbd;
and is also controlled by options in the &smb.conf; file.
Samba can act as a local browse master for a workgroup and the ability
to support domain logons and scripts is now available.
</para>

<para>
Samba can also act as a Domain Master Browser for a workgroup. This
means that it will collate lists from Local Master Browsers into a
wide area network server list. In order for browse clients to
resolve the names they may find in this list, it is recommended that
both Samba and your clients use a WINS server.
</para>

<para>
Do not set Samba to be the Domain Master for a workgroup that has the same
name as an NT Domain. On each wide area network, you must only ever have one
Domain Master Browser per workgroup, regardless of whether it is NT, Samba
or any other type of domain master that is providing this service.
</para>

<note><para>
<command>nmbd</command> can be configured as a WINS server, but it is not
necessary to specifically use Samba as your WINS server. MS Windows
NT4, Server or Advanced Server 200x can be configured as
your WINS server. In a mixed NT/200x server and Samba environment on
a Wide Area Network, it is recommended that you use the Microsoft
WINS server capabilities. In a Samba-only environment, it is
recommended that you use one and only one Samba server as the WINS server.
</para></note>

<para>
To get browsing to work you need to run nmbd as usual, but will need
to use the <smbconfoption><name>workgroup</name></smbconfoption> option in &smb.conf;
to control what workgroup Samba becomes a part of.
</para>

<para>
Samba also has a useful option for a Samba server to offer itself for
browsing on another subnet. It is recommended that this option is only
used for <quote>unusual</quote> purposes: announcements over the Internet, for
example. See <smbconfoption><name>remote announce</name></smbconfoption> in the 
&smb.conf; man page. 
</para>
</sect2>

<sect2>
<title>Problem Resolution</title>

<para>
If something does not work, the <filename>log.nmbd</filename> file will help
to track down the problem. Try a <smbconfoption><name>log level</name><value></value></smbconfoption> of 2 or 3 for finding
problems. Also note that the current browse list usually gets stored
in text form in a file called <filename>browse.dat</filename>.
</para>

<para>
If it does not work, you should still be able to
type the server name as <filename>\\SERVER</filename> in <command>filemanager</command>, then
press enter and <command>filemanager</command> should display the list of available shares.
</para>

<para>
Some people find browsing fails because they do not have the global
<smbconfoption><name>guest account</name></smbconfoption> set to a valid account. Remember that the
IPC$ connection that lists the shares is done as guest and, thus, you must have a valid guest account.
</para>

<para>
MS Windows 2000 and later (as with Samba) can be configured to disallow
anonymous (i.e., guest account) access to the IPC$ share. In that case, the
MS Windows 2000/XP/2003 machine acting as an SMB/CIFS client will use the
name of the currently logged-in user to query the IPC$ share. MS Windows
9x/Me clients are not able to do this and thus will not be able to browse
server resources.
</para>

<para>
The other big problem people have is that their broadcast address,
netmask or IP address is wrong (specified with the <smbconfoption><name>interfaces</name><value></value></smbconfoption> option
in &smb.conf;)
</para>
</sect2>

<sect2>
<title>Cross-Subnet Browsing</title>

<para>
<indexterm><primary>replication</primary><secondary>browse lists</secondary></indexterm>
Since the release of Samba 1.9.17 (alpha1), Samba has supported the
replication of browse lists across subnet boundaries. This section
describes how to set this feature up in different settings.
</para>

<para>
To see browse lists that span TCP/IP subnets (i.e., networks separated
by routers that do not pass broadcast traffic), you must set up at least
one WINS server. The WINS server acts as a DNS for NetBIOS names. This will
allow NetBIOS name-to-IP address translation to be completed by a direct
query of the WINS server. This is done via a directed UDP packet on
port 137 to the WINS server machine. The WINS server avoids the necessity
of default NetBIOS name-to-IP address translation, which is done
using UDP broadcasts from the querying machine. This means that machines
on one subnet will not be able to resolve the names of machines on
another subnet without using a WINS server.
</para>

<para>
Remember, for browsing across subnets to work correctly, all machines,
be they Windows 95, Windows NT or Samba servers, must have the IP address
of a WINS server given to them by a DHCP server, or by manual configuration 
(for Windows 9x/Me and Windows NT/200x/XP, this is in the TCP/IP Properties, under Network 
settings); for Samba, this is in the &smb.conf; file.
</para>

<sect3>
<title>Behavior of Cross-Subnet Browsing</title>

<para>
Cross-subnet Browsing is a complicated dance, containing multiple
moving parts. It has taken Microsoft several years to get the code
that achieves this correct, and Samba lags behind in some areas.
Samba is capable of cross-subnet browsing when configured correctly.
</para>

<para>
Consider a network set up as in <link linkend="browsing1">Cross-Subnet Browsing Example</link>.
</para>

<image id="browsing1" scale="40"><imagedescription>Cross-Subnet Browsing Example.</imagedescription><imagefile>browsing1</imagefile></image>
	
<para>
This consists of 3 subnets (1, 2, 3) connected by two routers
(R1, R2) which do not pass broadcasts. Subnet 1 has five machines
on it, subnet 2 has four machines, subnet 3 has four machines. Assume
for the moment that all machines are configured to be in the
same workgroup (for simplicity's sake). Machine N1_C on subnet 1
is configured as Domain Master Browser (i.e., it will collate the
browse lists for the workgroup). Machine N2_D is configured as
WINS server and all the other machines are configured to register
their NetBIOS names with it.
</para>

<para>
As these machines are booted up, elections for master browsers
will take place on each of the three subnets. Assume that machine
N1_C wins on subnet 1, N2_B wins on subnet 2, and N3_D wins on
subnet 3. These machines are known as Local Master Browsers for
their particular subnet. N1_C has an advantage in winning as the
Local Master Browser on subnet 1 as it is set up as Domain Master
Browser.
</para>

<para>
On each of the three networks, machines that are configured to 
offer sharing services will broadcast that they are offering
these services. The Local Master Browser on each subnet will
receive these broadcasts and keep a record of the fact that
the machine is offering a service. This list of records is
the basis of the browse list. For this case, assume that
all the machines are configured to offer services, so all machines
will be on the browse list.
</para>

<para>
For each network, the Local Master Browser on that network is
considered <quote>authoritative</quote> for all the names it receives via
local broadcast. This is because a machine seen by the Local Master
Browser via a local broadcast must be on the same network as the
Local Master Browser and thus is a <quote>trusted</quote>
and <quote>verifiable</quote> resource. Machines on other networks that
the Local Master Browsers learn about when collating their
browse lists have not been directly seen. These records are
called <quote>non-authoritative.</quote>
</para>

<para>
At this point the browse lists appear as shown in <link linkend="browsubnet">the next example</link> (these are 
the machines you would see in your network neighborhood if you looked in it on a particular network right now).
</para>

<para>
<table frame="all" id="browsubnet">
	<title>Browse Subnet Example 1</title>		
	<tgroup align="left" cols="3">
	<thead>
		<row><entry>Subnet</entry><entry>Browse Master</entry><entry>List</entry></row>
	</thead>

	<tbody>
		<row><entry>Subnet1</entry><entry>N1_C</entry><entry>N1_A, N1_B, N1_C, N1_D, N1_E</entry></row>
		<row><entry>Subnet2</entry><entry>N2_B</entry><entry>N2_A, N2_B, N2_C, N2_D</entry></row>
		<row><entry>Subnet3</entry><entry>N3_D</entry><entry>N3_A, N3_B, N3_C, N3_D</entry></row>
	</tbody>
	</tgroup>
</table>
</para>

<para>
At this point all the subnets are separate, and no machine is seen across any of the subnets.
</para>

<para>
Now examine subnet 2. As soon as N2_B has become the Local
Master Browser it looks for a Domain Master Browser with which to synchronize
its browse list. It does this by querying the WINS server
(N2_D) for the IP address associated with the NetBIOS name 
WORKGROUP&lt;1B&gt;. This name was registered by the Domain Master
Browser (N1_C) with the WINS server as soon as it was started.
</para>

<para>
Once N2_B knows the address of the Domain Master Browser, it
tells it that is the Local Master Browser for subnet 2 by
sending a <emphasis>MasterAnnouncement</emphasis> packet as a UDP port 138 packet.
It then synchronizes with it by doing a <emphasis>NetServerEnum2</emphasis> call. This
tells the Domain Master Browser to send it all the server
names it knows about. Once the Domain Master Browser receives
the <emphasis>MasterAnnouncement</emphasis> packet, it schedules a synchronization
request to the sender of that packet. After both synchronizations
are complete the browse lists look as shown in <link linkend="brsbex">following example</link>:
</para>

<table frame="all" id="brsbex">
	<title>Browse Subnet Example 2</title>		
	<tgroup	cols="3">
		<colspec align="left"/>
		<colspec align="left"/>
		<colspec align="justify" colwidth="1*"/>
	<thead>
		<row><entry>Subnet</entry><entry>Browse Master</entry><entry>List</entry></row>
	</thead>

	<tbody>
		<row><entry>Subnet1</entry><entry>N1_C</entry><entry>N1_A, N1_B, N1_C, N1_D, N1_E,
N2_A(*), N2_B(*), N2_C(*), N2_D(*)</entry></row>
		<row><entry>Subnet2</entry><entry>N2_B</entry><entry>N2_A, N2_B, N2_C, N2_D, N1_A(*), 
N1_B(*), N1_C(*), N1_D(*), N1_E(*)</entry></row>
		<row><entry>Subnet3</entry><entry>N3_D</entry><entry>N3_A, N3_B, N3_C, N3_D</entry></row>
	</tbody>
	</tgroup>
</table>

<para>
Servers with an (*) after them are non-authoritative names.
</para>

<para>
At this point users looking in their network neighborhood on
subnets 1 or 2 will see all the servers on both, users on
subnet 3 will still only see the servers on their own subnet.
</para>

<para>
The same sequence of events that occurred for N2_B now occurs
for the Local Master Browser on subnet 3 (N3_D). When it
synchronizes browse lists with the Domain Master Browser (N1_A)
it gets both the server entries on subnet 1, and those on
subnet 2. After N3_D has synchronized with N1_C and vica versa,
the browse lists will appear as shown in <link linkend="brsex2">following example</link>.
</para>

<table frame="all" id="brsex2">
	<title>Browse Subnet Example 3</title>		
	<tgroup cols="3" align="left">
		<colspec align="left"/>
		<colspec align="left"/>
		<colspec align="justify" colwidth="1*"/>

	<thead>
		<row><entry>Subnet</entry><entry>Browse Master</entry><entry>List</entry></row>
	</thead>

	<tbody>
		<row><entry>Subnet1</entry><entry>N1_C</entry><entry>N1_A, N1_B, N1_C, N1_D, N1_E, 
N2_A(*), N2_B(*), N2_C(*), N2_D(*), N3_A(*), N3_B(*), N3_C(*), N3_D(*)</entry></row>
		<row><entry>Subnet2</entry><entry>N2_B</entry><entry>N2_A, N2_B, N2_C, N2_D, N1_A(*), 
N1_B(*), N1_C(*), N1_D(*), N1_E(*)</entry></row>
		<row><entry>Subnet3</entry><entry>N3_D</entry><entry>N3_A, N3_B, N3_C, N3_D, N1_A(*), 
N1_B(*), N1_C(*), N1_D(*), N1_E(*), N2_A(*), N2_B(*), N2_C(*), N2_D(*)</entry></row>
	</tbody>
	</tgroup>
</table>

<para>
Servers with an (*) after them are non-authoritative names.
</para>

<para>
At this point, users looking in their network neighborhood on
subnets 1 or 3 will see all the servers on all subnets, while users on
subnet 2 will still only see the servers on subnets 1 and 2, but not 3.
</para>

<para>
Finally, the Local Master Browser for subnet 2 (N2_B) will sync again
with the Domain Master Browser (N1_C) and will receive the missing
server entries. Finally, as when a steady state (if no machines
are removed or shut off) has been achieved, the browse lists will appear
as shown in <link linkend="brsex3">example below</link>.
</para>

<table frame="all" id="brsex3">
	<title>Browse Subnet Example 4</title>		
	<tgroup cols="3" align="left">
		<colspec align="left"/>
		<colspec align="left"/>
		<colspec align="justify" width="1*"/>

	<thead>
		<row><entry>Subnet</entry><entry>Browse Master</entry><entry>List</entry></row>
	</thead>

	<tbody>
		<row><entry>Subnet1</entry><entry>N1_C</entry><entry>N1_A, N1_B, N1_C, N1_D, N1_E,
N2_A(*), N2_B(*), N2_C(*), N2_D(*), N3_A(*), N3_B(*), 
N3_C(*), N3_D(*)</entry></row>
		<row><entry>Subnet2</entry><entry>N2_B</entry><entry>N2_A, N2_B, N2_C, N2_D, N1_A(*), 
N1_B(*), N1_C(*), N1_D(*), N1_E(*), N3_A(*), N3_B(*), 
N3_C(*), N3_D(*)</entry></row>
		<row><entry>Subnet3</entry><entry>N3_D</entry><entry>N3_A, N3_B, N3_C, N3_D, N1_A(*), 
N1_B(*), N1_C(*), N1_D(*), N1_E(*), N2_A(*), N2_B(*), 
N2_C(*), N2_D(*)</entry></row>
	</tbody>
	</tgroup>
</table>

<para>
Servers with an (*) after them are non-authoritative names.
</para>

<para>
Synchronizations between the Domain Master Browser and Local
Master Browsers will continue to occur, but this should remain a
steady state operation.
</para>

<para>
If either router R1 or R2 fails, the following will occur:
</para>

<orderedlist>
<listitem>
	<para>
	Names of computers on each side of the inaccessible network fragments
	will be maintained for as long as 36 minutes in the network neighborhood
	lists.
	</para>
</listitem>

<listitem>
	<para>
	Attempts to connect to these inaccessible computers will fail, but the
	names will not be removed from the network neighborhood lists.
	</para>
</listitem>

<listitem>
	<para>
	If one of the fragments is cut off from the WINS server, it will only
	be able to access servers on its local subnet using subnet-isolated
	broadcast NetBIOS name resolution. The effects are similar to that of
	losing access to a DNS server.
	</para>
</listitem>
</orderedlist>
</sect3>
</sect2>
</sect1>

<sect1>
<title>Common Errors</title>

<para>
Many questions are asked on the mailing lists regarding browsing. The majority of browsing
problems originate from incorrect configuration of NetBIOS name resolution. Some are of
particular note.
</para>

<sect2>
<title>How Can One Flush the Samba NetBIOS Name Cache without Restarting Samba?</title>

<para>
<indexterm><primary>flush name cache</primary></indexterm>
Samba's <command>nmbd</command> process controls all browse list handling. Under normal circumstances it is
safe to restart <command>nmbd</command>. This will effectively flush the Samba NetBIOS name cache and cause it
to be rebuilt. This does not make certain that a rogue machine name will not re-appear
in the browse list. When <command>nmbd</command> is taken out of service, another machine on the network will
become the Browse Master. This new list may still have the rogue entry in it. If you really
want to clear a rogue machine from the list, every machine on the network will need to be
shut down and restarted after all machines are down. Failing a complete restart, the only
other thing you can do is wait until the entry times out and is then flushed from the list.
This may take a long time on some networks (perhaps months).
</para>

</sect2>
 
<sect2>
	<title>Server Resources Can Not Be Listed</title>

<para><quote>My Client Reports <quote>This server is not configured to list shared resources</quote></quote></para>

		
<para>
Your guest account is probably invalid for some reason. Samba uses the
guest account for browsing in <command>smbd</command>. Check that your guest account is
valid.
</para>

<para>Also see <smbconfoption><name>guest account</name></smbconfoption> in the &smb.conf; man page.</para>

</sect2>

<sect2>
	<title>I get an <errorname>`Unable to browse the network'</errorname> error</title>

	<para>This error can have multiple causes:
<indexterm><primary>browsing problems</primary></indexterm>
	</para>
	
	<itemizedlist>
		<listitem><para>There is no Local Master Browser. Configure &nmbd; 
			or any other machine to serve as Local Master Browser.</para></listitem>
		<listitem><para>You cannot log onto the machine that is the local master 
			browser. Can you logon to it as a guest user? </para></listitem>
		<listitem><para>There is no IP connectivity to the Local Master Browser. 
			Can you reach it by broadcast?</para></listitem>
</itemizedlist>
</sect2>

<sect2>
<title>Browsing of Shares and Directories is Very Slow</title>

<para><quote>
<indexterm><primary>slow browsing</primary></indexterm>
There are only two machines on a test network. One a Samba server, the other a Windows XP machine.
Authentication and logons work perfectly, but when I try to explore shares on the Samba server, the
Windows XP client becomes unresponsive. Sometimes it does not respond for some minutes. Eventually,
Windows Explorer will respond and displays files and directories without problem.
display file and directory.</quote>
</para>

<para><quote>
But, the share is immediately available from a command shell (<command>cmd</command>, followed by 
exploration with dos command. Is this a Samba problem or is it a Windows problem? How can I solve this?
</quote></para>

<para>
Here are a few possibilities:
</para>

<variablelist>
	<varlistentry>
		<term>Bad Networking Hardware</term>
		<listitem><para>
<indexterm><primary>bad hardware</primary></indexterm>
<indexterm><primary>WebClient</primary></indexterm>
		Most common defective hardware problems center around low cost or defective HUBs, routers,
		Network Interface Controllers (NICs) and bad wiring. If one piece of hardware is defective
		the whole network may suffer. Bad networking hardware can cause data corruption. Most bad
		networking hardware problems are accompanied by an increase in apparent network traffic,
		but not all.
		</para></listitem>
	</varlistentry>
	
	<varlistentry>
		<term>The Windows XP WebClient</term>
		<listitem><para>
		A number of sites have reported similar slow network browsing problems and found that when
		the WebClient service is turned off, the problem disappears. This is certainly something
		that should be explored as it is a simple solution &smbmdash; if it works.
		</para></listitem>
	</varlistentry>
	
	<varlistentry>
		<term>Inconsistent WINS Configuration</term>
		<listitem><para>
		This type of problem is common when one client is configured to use a WINS server (that is
		a TCP/IP configuration setting) and there is no WINS server on the network. Alternately,
		this will happen is there is a WINS server and Samba is not configured to use it. The use of
		WINS is highly recommended if the network is using NetBIOS over TCP/IP protocols. If use
		of NetBIOS over TCP/IP is disabled on all clients, Samba should not be configured as a WINS
		server neither should it be configured to use one.
		</para></listitem>
	</varlistentry>
	
	<varlistentry>
		<term>Incorrect DNS Configuration</term>
		<listitem><para>
		If use of NetBIOS over TCP/IP is disabled, Active Directory is in use and the DNS server
		has been incorrectly configured. Refer <link linkend="adsdnstech">DNS and Active Directory</link> for more information.
		</para></listitem>
	</varlistentry>
</variablelist>

</sect2>
</sect1>
</chapter>

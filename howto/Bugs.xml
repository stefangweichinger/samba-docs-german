<?xml version="1.0" encoding="ISO-8859-1"?>
<chapter id="bugreport">

<chapterinfo>
	&author.jht;
	&author.jelmer;
	&author.tridge;
	<pubdate> 27 June 1997 </pubdate>
	<author>&person.hba;<contrib>Deutsche Übersetzung</contrib></author>
</chapterinfo>

<title>Das Melden von Fehlern</title>

<sect1>
<title>Einführung</title>

<para>Bitte verwenden Sie <ulink url="https://bugzilla.samba.org/">Bugzilla</ulink>,
um Bugs zu melden, und lesen Sie zunächst dieses Kapitel, bevor Sie einen Bug melden. Bitte prüfen 
Sie gleichfalls, ob sich dieser Text nach einem Releasewechsel geändert hat, da wir 
an einigen Punkten den Mechanismus zum Thema Bug-Report ändern.
</para>

<para>
Bitte geben Sie so viele Informationen in dem Bug-Report an, wie Sie können. Wir 
bekommen täglich mehr Mails, als wir beantworten können, also helfen Sie uns bitte,
indem Sie Ihren Bug so <quote>entwickler-freundlich</quote> wie nur eben möglich beschreiben.
</para>

<para>
Bitte gehen Sie nicht davon aus, dass wir, wenn Sie einen Bug in der Newsgroup comp.protocols.smb posten, 
diese Nachricht lesen. Wenn Sie vermuten, dass es weniger ein Bug als ein Konfigurationsproblem ist, 
wenden Sie sich bitte an die Samba-Mailingliste, da dort Tausende von anderen Benutzern evtl. in der 
Lage sind, Ihnen zu helfen.
</para>

<para>
Ebenfalls hilfreich ist ein Durchsuchen der Mailinglisten-Archive, die über die Samba-Webseite 
<ulink noescape="1" url="http://samba.org/samba/">http://samba.org/samba/</ulink> zu erreichen sind.
</para>

</sect1>

<sect1>
<title>Allgemeine Informationen</title>

<para>
Bevor Sie einen Bug-Report senden, prüfen Sie bitte Ihre Konfiguration auf Tippfehler.
Sehen Sie sich auch Ihre Log-Dateien daraufhin an, ob diese ggf. eine Nachricht anzeigen, dass 
etwas falsch konfiguriert worden ist. Um die Syntax Ihrer Konfiguration zu prüfen, führen 
Sie bitte &testparm; aus.
</para>

<para>
Haben Sie in <link linkend="diagnosis"/> nachgeschaut? Dies ist absolut wichtig!
</para>

<para>
Wenn Sie Teile Ihrer Log-Dateien mit dem Report senden, stellen Sie sicher, dass 
Sie sie entsprechend Ihrer Tätigkeit am Client kommentieren und und mitteilen, wie sich 
das Resultat darstellt.
</para>

</sect1>

<sect1>
<title>Debug-Level</title>

<para>
Wenn der Bug etwas damit zu tun hat, dass sich Samba als Server inkorrekt verhält (etwa 
es ablehnt, eine Datei zu öffnen), sind die Log-Dateien sehr nützlich. 
Je nach Problem ist ein Log-Level zwischen 3 und 10 sehr hilfreich, um das Problem zu analysieren. Ein höherer Log Level verspricht mehr Detail-Informationen, benötigt allerdings auch mehr 
Speicherkapazität.
</para>

<para>
Um den Debug-Level einzustellen, verwenden Sie die Option <smbconfoption><name>log level</name></smbconfoption> 
in Ihrer &smb.conf;. Es ist nützlich, für jede Maschine eine eigene Log-Datei zu verwenden 
und nur für eine Maschine den Log-Level höher einzustellen. Wenn Sie dies machen möchten, fügen Sie
bitte folgende Zeilen zu Ihrer &smb.conf; hinzu:
</para>

<para><smbconfblock>
<smbconfoption><name>log level</name><value>10</value></smbconfoption>
<smbconfoption><name>log file</name><value>/usr/local/samba/lib/log.%m</value></smbconfoption>
<smbconfoption><name>include</name><value>/usr/local/samba/lib/smb.conf.%m</value></smbconfoption>
</smbconfblock></para>

<para>
Erstellen Sie außerdem eine Datei <filename>/usr/local/samba/lib/smb.conf.<replaceable>machine</replaceable></filename>,
wobei <replaceable>machine</replaceable> der Name des Clients ist, den Sie debuggen wollen.
In dieser Datei können Sie alle &smb.conf;-Optionen setzen, zum Beispiel ist das Setzen des Parameters
<smbconfoption><name>log level</name></smbconfoption> nützlich. Hier können Sie auch 
mit verschiedenen Sicherheitsoptionen experimentieren.
</para>

<para>
Der &smb.conf;-Eintrag <smbconfoption><name>log level</name></smbconfoption> ist ein Synonym für 
<smbconfoption><name>debuglevel</name></smbconfoption>, der in älteren Versionen von Samba verwendet wurde und dazu dient, die Abwärtskompatibilität zu älteren &smb.conf;-Dateien zu gewährleisten.
</para>

<para>
Sobald der Wert für den <smbconfoption><name>log level</name></smbconfoption> erhöht und Samba neu 
gestartet worden ist, werden Sie eine signifikant größere Menge an Debug-Informationen erhalten. Für 
gewöhnlich werden Sie keinen Level höher als <constant>3</constant> benötigen. Nahezu jeder Bug kann mit einem 
Log-Level von <constant>10</constant> festgestellt werden, aber machen Sie sich auf ein großes 
Datenvolumen an Log-Dateien gefasst.
</para>

</sect1>

<sect1>
<title>Interne Fehler</title>

<para>
Wenn Sie in Ihren Log-Dateien einen <quote><errorname>INTERNAL ERROR</errorname></quote>  bemerken sollten, 
bedeutet dies, dass Samba ein nicht erwartetes Signal bekommen hat. Dies ist wahrscheinlich
ein <quote>segmentation fault</quote> und deutet so gut wie sicher auf einen Bug in Samba hin
(vorausgesetzt, Ihre Hardware oder Systemsoftware funktioniert einwandfrei).
</para>

<para>
Sollte die Nachricht vom smbd stammen, ist es meistens so, dass vor dieser Nachricht das Log noch die letzte 
SMB-Meldung enthält, die der smbd erhalten hat. Diese Information ist oft sehr nützlich, um
das Problem zu lokalisieren: Bitte fügen Sie daher diese Meldung Ihrem Bug-Report hinzu.
</para>

<para>
Falls möglich sollten Sie so detailliert wie möglich erklären können, wie das Problem reproduziert werden kann.
</para>


<para>
<indexterm><primary>Core-Dateien</primary></indexterm>
Sie werden ebenfalls eine so genannte Core-Datei in einem <filename>corefiles</filename> 
-Unterverzeichnis in Ihrem Log-Verzeichnis entdecken. 
Diese Datei ist das nützlichste Tool, um einen Bug zu verfolgen. Um es zu verwenden, machen Sie Folgendes:
<indexterm><primary>gdb</primary></indexterm>
<indexterm><primary>debug</primary></indexterm>
</para>


<screen>
&prompt;<userinput>gdb smbd core</userinput>
</screen>

<para>
Fügen Sie die jeweiligen Pfade zu smbd und der Core-Datei zu gdb hinzu, damit gdb sie finden kann.
Wenn Sie gdb nicht haben sollten, versuchen Sie es mit <userinput>dbx</userinput>.
Anschließend verwenden Sie innerhalb des Debuggers das Kommando <command>where</command>, um 
einen stack-Trace der Stelle zu erhalten, an der das Problem auftrat. 
Fügen Sie diese Information der Bug-Meldung hinzu.
</para>

<para>
Wenn Sie Kenntnisse in einer Assembler-Sprache haben, führen Sie ein <command>disass</command>-Kommando zu der Routine hinzu, in der das Problem auftrat (wenn es in einer Library-Routine war,
disassemblieren Sie die Routine, die sie aufgerufen hat), und versuchen Sie festzustellen, an welcher 
Stelle das Problem liegt, indem Sie sich den Code ansehen. Selbst wenn Sie keine Kenntnisse in 
Assembler-Programmierung haben, sollten Sie diese Information dem Report hinzufügen, dies kann sehr hilfreich sein.
</para>
</sect1>

<sect1>
<title>Sich an einen laufenden Prozess anschließen</title>

<para>
Leider lassen es einige UNIX-Varianten (zum Teil auch einige Linux-Kernel) nicht zu, 
einen Coredump zu erstellen, wenn der Prozess die UID ändert (was smbd oft tut).
Um dies dennoch zu debuggen, könnten Sie versuchen, sich in den laufenden Prozess 
einzuklinken, indem Sie <userinput>gdb smbd <replaceable>PID</replaceable></userinput>
ausführen, wobei Sie die <replaceable>PID</replaceable> aus dem <application>smbstatus</application> 
entnehmen können.
Anschließend verwenden Sie das <command>c</command>-Kommando, um fortzufahren und um zu versuchen,
den Coredump mit Hilfe des Clients zu erzeugen. Der Debugger sollte den Fehler erfassen und Ihnen 
mitteilen, wo er auftrat.
</para>

</sect1>

<sect1>
<title>Patches</title>


<para>
<indexterm><primary>diff</primary></indexterm>
<indexterm><primary>patch</primary></indexterm>
Die beste Art von Bug-Reports sind die, die bereits einen Fix beinhalten! Wenn Sie uns Patches 
schicken, verwenden Sie bitte das <userinput>diff -u</userinput>-Format, wenn Ihre Version von diff 
dies bereitstellt. Ansonsten verwenden Sie bitte <userinput>diff -c4</userinput>.
Stellen Sie sicher, dass Sie Ihr diff gegen eine saubere Version des Source-Codes erstellen,
und lassen Sie uns wissen, welche Version genau Sie verwenden.
</para>

</sect1>
</chapter>

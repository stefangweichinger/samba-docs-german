<?xml version="1.0" encoding="ISO-8859-1"?>
<chapter id="groupmapping">
<chapterinfo>
	&author.jht;
	<author>
		<firstname>Jean François</firstname><surname>Micouleau</surname>
	</author>
	&author.jerry;
	<author>&person.luft;<contrib>Deutsche Übersetzung</contrib></author>
</chapterinfo>
<title>Das Gruppen-Mapping &smbmdash; zwischen MS Windows und UNIX</title>


	<para>
<indexterm significance="preferred"><primary>Gruppen</primary><secondary>Mapping</secondary></indexterm>
	Mit der Einführung von Samba 3 wurden neue Gruppen-Mapping-Funktionen eingebaut, die Verbindungen
	zwischen Unix-Gruppen und Windows-Gruppen-SIDs ermöglichen. Das Unterkommando <command>groupmap</command>,
	das zum Kommando &net; gehört, wird für das Verbinden der Gruppen verwendet.
	</para>

	<para>
	Die neuen Merkmale des Gruppen-Mappings ermöglichen es dem Administrator zu entscheiden, welche NT-Domänengruppen
	dem MS Windows-Client zugeordnet werden. Es werden nur jene NT-Domänengruppen in den 
	Werkzeugen zur Bearbeitung von Domänen-Benutzern und -Gruppen angezeigt, die auf eine Unix-Gruppe gemappt wurden
	und nicht dem Standardwert (<constant>-1</constant>) zugeordnet wurden.
 	</para>

	<warning>
	<para>
	<indexterm><primary>Domänen-Administratoren-Gruppe</primary></indexterm>
	Der Parameter <parameter>domain admin group</parameter> wurde aus Samba-3 entfernt und sollte nicht
	länger verwendet werden. In Samba-2.2.x-Versionen wurde dieser Parameter verwendet, um einer bestimmten
	Liste von Benutzern die Mitgliedschaft in der Domänen-Administratoren-Gruppe zu geben, die lokale Administrator-
	Rechte auf den Client Rechner vergibt (in Standard-Konfigurationen).
	</para>
	</warning>

<sect1>
<title>Eigenschaften und Vorzüge</title>

	<para>
	Samba ermöglicht dem Administrator das Anlegen von MS Windows NT4/200x-Gruppenkonten, die
	auf beliebige UNIX/Linux-Gruppen gemappt werden können.	
	</para>

	<para>
<indexterm><primary>UID</primary></indexterm>
<indexterm><primary>GID</primary></indexterm>
	Gruppenkonten können mit den MS Windows 200x/XP Professional MMC-Tools verwaltet werden.
	In der Datei &smb.conf; können entsprechende Skripten verwendet werden, um mit diesen MMC-Tools 
	automatisch UNIX/Linux-Konten anzulegen. Wenn diese Skripten nicht angegeben werden und der
	<command>winbindd</command> läuft, werden die Samba-Gruppenkonten den Parametern von 
	<smbconfoption><name>idmap uid</name></smbconfoption>/<smbconfoption><name>idmap gid</name></smbconfoption>
	der &smb.conf; zugeordnet.
	</para>

	<figure id="idmap-sid2gid"><title>IDMAP: Auflösung der Gruppen-SID in eine GID</title>
	<mediaobject>
	<imageobject role="latex"><imagedata fileref="projdoc/imagefiles/idmap-sid2gid" scale="50" scalefit="1"/></imageobject>
	<imageobject><imagedata fileref="projdoc/imagefiles/idmap-sid2gid.png" scale="50" scalefit="1"/></imageobject>
	</mediaobject>
	</figure>
	<!-- (((Bild Im PDF nicht vorhanden))) -->

	<figure id="idmap-gid2sid"><title>IDMAP: GID-Auflösung in eine passende SID</title>
	<mediaobject>
	<imageobject role="latex"><imagedata fileref="projdoc/imagefiles/idmap-gid2sid" scale="50" scalefit="1"/></imageobject>
	<imageobject><imagedata fileref="projdoc/imagefiles/idmap-gid2sid.png" scale="50" scalefit="1"/></imageobject>
	</mediaobject>
	</figure>

	<para>
	In beiden Fällen können, wenn winbindd nicht läuft, nur lokal auflösbare Gruppen erkannt werden (siehe auch
	<link linkend="idmap-sid2gid">IDMAP: Auflösung der Gruppen SID zur GID</link> und <link linkend="idmap-gid2sid">IDMAP: GID Auflösung zu passender SID</link>). 
	Das Kommando <command>net groupmap</command> wird verwendet, um UNIX-Gruppen zu NT-SID-Mappings wie in 
	<link linkend="idmap-store-gid2sid">IDMAP: Speichern von Gruppen-Mappings</link> zu erstellen.
	</para>
	<!-- (((Bild Im PDF nicht vorhanden))) -->
	

	<figure id="idmap-store-gid2sid"><title>IDMAP: Speichern von Gruppen-Mappings</title>
	<mediaobject>
	<imageobject role="latex"><imagedata fileref="projdoc/imagefiles/idmap-store-gid2sid" scale="50" scalefit="1"/></imageobject>
	<imageobject><imagedata fileref="projdoc/imagefiles/idmap-store-gid2sid.png" scale="50" scalefit="1"/></imageobject>
	</mediaobject>
	</figure>


	<para>
	<indexterm><primary>groupadd</primary></indexterm>
	<indexterm><primary>groupdel</primary></indexterm>
	Administratoren sollten beachten, dass &smb.conf; Gruppen-Interface-Skripten direkt die UNIX/Linux-Systemwerkzeuge
	(die Shadow-Utilities <command>groupadd</command>, <command>groupdel</command> und <command>groupmod</command>) 
	verwenden. Die resultierenden Gruppennamen können nur Zeichen enthalten, die auch die oben genannten Werkzeuge
	bearbeiten können. Wenn die Werkzeuge keine Großbuchstaben oder Leerzeichen erlauben, wird das Erstellen der
	Gruppe <ntgroup>Domänen-Administratoren</ntgroup> nicht möglich sein.
	</para>


	<para>
	<indexterm><primary>GID</primary></indexterm>
	<indexterm><primary>SID</primary></indexterm>
	Es gibt verschiedene Lösungswege für solche Einschränkungen verschiedener Betriebsysteme.
	Eine Möglichkeit besteht darin, Skripten zu verwenden, die die Systemeinschränkungen kennen und dann nur
	die UNIX/Linux-Gruppen-ID (GID) an Samba zurückgeben. Dies ist ein dynamischer Workaround.
	</para>

	<para>
	Ein anderer Lösungsansatz ist die manuelle Erstellung der UNIX/Linux- und MS Windows NT4/200x-Gruppen am Samba-Server und die Verwendung des Werkzeugs <command>net groupmap</command>, um die 
	Gruppen zu <quote>verbinden</quote>.
	</para>

</sect1>

<sect1>
<title>Diskussion</title>

	<para>
	Bei der Installation von <application>MS Windows NT4/200x</application> auf einem Computer
	erstellt das Installationsprogramm Benutzer und Gruppen, insbesondere die <constant>Administratoren</constant>-Gruppe. Diese Gruppe erhält die nötigen Rechte, um wichtige Systemaufgaben, wie die Änderung der Zeit
	und das Beenden von Programmen, auszuführen.
	</para>

	<para>
	<indexterm><primary>Administrator</primary></indexterm>
	Der Benutzer <constant>Administrator</constant> ist Mitglied der Gruppe <constant>Administratoren</constant>.
	Dies vererbt die Gruppenrechte der <constant>Administratoren</constant>.
	Falls ein Benutzer <constant>joe</constant> erzeugt wird, der Mitglied der Gruppe 
	<constant>Administratoren</constant>
	ist, so hat <constant>joe</constant> genau diesselben Rechte wie der Benutzer <constant>Administrator</constant>.
	</para>

	<para>
	Wenn eine MS Windows NT/200x/XP-Maschine zum Domänenmitglied gemacht wird, so wird die 
	Gruppe <quote>Domänen-Administratoren</quote>
	des PDC zu der lokalen Gruppe <constant>Administratoren</constant> der Arbeitsstation hinzugefügt.
	Jedes Mitglied der Gruppe <constant>Domänen-Administratoren</constant> vererbt die Rechte der lokalen
	Gruppe <constant>Administratoren</constant>, wenn diese sich an der Arbeitsstation anmelden.
	</para>

	<para>
	Die folgenden Schritte beschreiben, wie man Samba-PDC-Benutzer zu Mitgliedern der 
	Gruppe <constant>Domänen-Administratoren</constant> macht.
	</para>

	<orderedlist>
		<listitem><para>
		Erzeugen Sie eine UNIX-Gruppe (normalerweise in der Datei <filename>/etc/group</filename>); 
		nennen wir sie <constant>domadm</constant>.
		</para></listitem>

		<listitem><para>
		Fügen Sie dieser Gruppe die Benutzer hinzu, die <quote>Administrator</quote> sein müssen. 
		Falls Sie zum Beispiel <constant>joe, john</constant> und <constant>mary</constant>
		Administrator sein lassen wollen,
		sieht Ihr Eintrag in <filename>/etc/group</filename> wie folgt aus:
		</para>

		<para><programlisting>
		domadm:x:502:joe,john,mary
		</programlisting>
		</para></listitem>

		<listitem><para>
		Mappen Sie diese domadm-Gruppe auf die Gruppe <quote>Domänen-Administratoren</quote>,
		indem Sie den folgenden Befehl eingeben:
		</para>

		<para>
	<screen>
	&rootprompt;<userinput>net groupmap add ntgroup=<quote>Domänen Administratoren</quote> unixgroup=domadm</userinput>
	</screen>
	</para>
		
		<para>
		<indexterm><primary>Domänen-Administratoren-Gruppe</primary></indexterm>
		Die Anführungszeichen um <quote>Domänen Administratoren</quote> sind notwendig, weil der
		Gruppenname ein Leerzeichen enthält.
		Stellen Sie zudem sicher, dass Sie keine Leerzeichen um das Gleichheitszeichen (=) übrig lassen.
		</para></listitem>
	</orderedlist>

	<para>
	Jetzt sind <constant>joe, john</constant> und <constant>mary</constant> Domänenadministratoren.
	</para>

	<para>
	<indexterm><primary>Gruppen</primary><secondary>Domäne</secondary></indexterm>
	Es ist möglich, jede beliebige UNIX-Gruppe auf jede Windows NT4/200x-Gruppe zu mappen, genauso wie
	jede UNIX-Gruppe zu einer Windows-Domänengruppe zu machen. Wenn Sie beispielsweise eine UNIX-Gruppe
	(z.B. acct) in eine ACL auf einer lokalen Datei oder Drucker auf einer Domänen-Mitgliedsmaschine 
	aufnehmen wollen, dann markieren Sie diese Gruppe als eine Domänengruppe auf dem Samba-PDC,
	indem Sie Folgendes eingeben:
	</para>

	<para>
<screen>
&rootprompt;<userinput>net groupmap add rid=1000 ntgroup="Accounting" unixgroup=acct</userinput>
</screen>
	</para>

	<para>
	Beachten Sie, dass der RID-Parameter ein unsigned 32-Bit-Integer ist, der normalerweise bei 1000 startet.
	Dieser RID darf sich jedoch nicht mit einem RID überschneiden, der einem Benutzer zugewiesen ist.
	Dies wird mit unterschiedlichen Verfahren überprüft, die von dem von Ihnen verwendeten passdb-Backend 
	abhängen. Künftige Versionen der Werkzeuge nehmen die Überprüfung eventuell automatisch vor, aber derzeit ist
	dies Ihre Aufgabe.
	</para>

	<sect2>
	<title>Wichtige administrative Informationen</title>

	<para>
	Administrative Rechte sind in zwei spezifischen Formen notwendig:
	</para>

	<orderedlist>
		<listitem><para>Für Samba-3-Domänencontroller und 
				Domänen-Mitgliedsserver/Clients</para></listitem>
		<listitem><para>Um Windows-Arbeitsstationen, die Domänenmitglied sind, zu verwalten</para></listitem>
	</orderedlist>

	<para>
	Administrative Aufgaben auf UNIX/Linux-Systemen, wie das Hinzufügen von Benutzern oder Gruppen, 
	setzen <constant>root</constant>-Level-Privilegien voraus. Das Hinzufügen eines Windows-Clients zu einer Samba-Domäne bringt das Hinzufügen
	eines Benutzerkontos für den Windows-Client mit sich.
	</para>

	<para>
	Viele UNIX-Administratoren beantragen wiederholt beim Samba-Team, es zu ermöglichen, 
	ohne <constant>root</constant>-Rechte Windows-Arbeitsstationen 
	oder Benutzerkonten hinzuzufügen und zu löschen.
	Eine solche Anfrage verletzt jedes Verständnis von grundlegender UNIX-Systemsicherheit.
	</para>

	<para>
	Es gibt keinen sicheren Weg, den Zugriff auf ein UNIX/Linux-System ohne <constant>root</constant>-Privilegien
	zur Verfügung zu stellen. Die Bereitstellung von <constant>root</constant>-Privilegien kann entweder durch
	Anmelden als <constant>root</constant> an der Domäne erfolgen, oder man kann bestimmten Benutzern erlauben, 
	ein UNIX-Konto zu benutzen,
	das Mitglied der UNIX-Gruppe ist, für die GID=0 als primäre Gruppe in der Datenbank 
	<filename>/etc/passwd</filename> definiert ist.
	Benutzer solcher Konten können Werkzeuge wie den NT 4-Domänen-Benutzermanager und den NT 4-Domänen-Servermanager verwenden, 
	um Benutzer- und Gruppenkonten ebenso zu verwalten wie Domänen-Mitgliedsserver und Client-Konten. 
	Diese Privilegienebene wird ebenfalls benötigt, um ACLs auf Freigabeebene zu verwalten.
	</para>

	<para>
	Administrative Aufgaben auf einer Windows-Arbeitsstation, die Domänenmitglied ist, können durch jeden, 
	der Mitglied der Gruppe <constant>Domänen Administratoren</constant> ist, durchgeführt werden.
	Diese Gruppe kann auf jede passende UNIX-Gruppe gemappt werden.
	</para>

	</sect2>

	<sect2>
	<title>Standardbezeichner für Benutzer, Gruppen und Beziehungen</title>

	<para>
<indexterm><primary>Relative Bezeichner</primary><see>RID</see></indexterm>
<indexterm><primary>RID</primary></indexterm>
	Beim ersten Installieren wird Microsoft Windows NT4/200x/XP mit einigen Benutzer-, Gruppen- und 
	Alias-Einheiten
	vorkonfiguriert. Jede hat einen bekannten relativen Bezeichner (RID). Dieser muss für die weitergehende
	Integrität von Operationen eindeutig bleiben. Samba muss mit gewissen lebensnotwendigen Domänengruppen 
	ausgestattet
	werden, die den entsprechenden RID-Wert verlangen. Wenn Samba-3 so konfiguriert wird, dass es <constant>tdbsam</constant> 
	nutzt, werden die lebensnotwendigen Domänengruppen automatisch angelegt. Es ist dann die Verantwortung 
	des LDAP-Administrators, die Standard-NT-Gruppen zu erzeugen (diese auszustatten).
	</para>

	<para>
	Jede grundlegende Domänengruppe muss ihrer zugehörigen bekannten RID zugeordnet werden. Die 
	Standard-Benutzer, Gruppen, Aliases und RIDs werden in der Tabelle
	<link linkend="WKURIDS">Bekannte Standardbenutzer-RIDs</link> angezeigt.
	</para>

	<para><note>
	Wenn das <parameter>passdb backend</parameter> LDAP (<constant>ldapsam</constant>) benutzt, ist der Administrator dafür verantwortlich, die notwendigen Domänengruppen zu erzeugen und diese ihrer
	jeweiligen RID zuzuweisen.
	</note></para>

	<para>
	Es ist zulässig, jede Domänengruppe, die benötigt wird, zu erzeugen. Stellen Sie lediglich sicher, 
	dass die notwendige (bekannt gegebene) Domänengruppe erzeugt worden ist und Ihrer Standard-RID
	zugewiesen worden ist. Andere Gruppen, die Sie anlegen, können Sie jeder beliebigen RID zuordnen, 
	die Sie benutzen möchten.
	</para>

	<para>
	Stellen Sie sicher, dass jede Domänengruppe auf eine UNIX-Systemgruppe gemappt wird. Dies ist der 
	einzige Weg, um sicherzustellen, dass die Gruppe als eine NT-Domänengruppe verfügbar sein wird.
	</para>

	<para>
	<table frame="all" id="WKURIDS">
	<title>Bekannte Standardbenutzer-RIDs</title>
		<tgroup cols="4" align="left">
			<colspec align="left"/>
			<colspec align="left"/>
			<colspec align="left"/>
			<colspec align="center"/>
			<thead>
				<row>
					<entry>Bekannte Einheit</entry>
					<entry>RID</entry>
					<entry>Typ</entry>
					<entry>Notwendig</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>Domänen-Administrator</entry>
					<entry>500</entry>
					<entry>Benutzer</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Gast</entry>
					<entry>501</entry>
					<entry>Benutzer</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domäne KRBTGT</entry>
					<entry>502</entry>
					<entry>Benutzer</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Administratoren</entry>
					<entry>512</entry>
					<entry>Gruppe</entry>
					<entry>Ja</entry>
				</row>
				<row>
					<entry>Domänenbenutzer</entry>
					<entry>513</entry>
					<entry>Gruppe</entry>
					<entry>Ja</entry>
				</row>
				<row>
					<entry>Domänengäste</entry>
					<entry>514</entry>
					<entry>Gruppe</entry>
					<entry>Ja</entry>
				</row>
				<row>
					<entry>Domänencomputer</entry>
					<entry>515</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänencontroller</entry>
					<entry>516</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Certificate-Administratoren</entry>
					<entry>517</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Schema-Administratoren</entry>
					<entry>518</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Enterprise-Administratoren</entry>
					<entry>519</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Domänen-Policy-Administratoren</entry>
					<entry>520</entry>
					<entry>Gruppe</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Administratoren</entry>
					<entry>544</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Benutzer</entry>
					<entry>545</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Gäste</entry>
					<entry>546</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Hauptbenutzer</entry>
					<entry>547</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Zugriffsoperator</entry>
					<entry>548</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-System-Operator</entry>
					<entry>549</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Drucker-Operator</entry>
					<entry>550</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Backup-Operator</entry>
					<entry>551</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-Replikator</entry>
					<entry>552</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
				<row>
					<entry>Builtin-RAS-Server</entry>
					<entry>553</entry>
					<entry>Alias</entry>
					<entry>Nein</entry>
				</row>
			</tbody>
		</tgroup>
	</table>
	</para>

	</sect2>

	<sect2>
	<title>Beispielkonfiguration</title>

		<para>
		Sie können die verschiedenen Gruppen in der Mapping-Datenbank anzeigen lassen, indem Sie 
		<command>net groupmap list</command> eingeben. Hier ist ein Beispiel:
		</para>

<indexterm><primary>net</primary><secondary>groupmap</secondary></indexterm>

		<para>
<screen>
&rootprompt; <userinput>net groupmap list</userinput>
Domänen Administratoren (S-1-5-21-2547222302-1596225915-2414751004-512) -> domadmin
Domänen Benutzer (S-1-5-21-2547222302-1596225915-2414751004-513) -> domuser
Domänen Gäste (S-1-5-21-2547222302-1596225915-2414751004-514) -> domguest
</screen>
		</para>

		<para>
		Ausführliche Details zu <command>net groupmap</command> finden Sie auf der net(8)-Manpage.
		</para>

	</sect2>

</sect1>

<sect1>
<title>Konfigurationskripten</title>

	<para>
	Jeder braucht Werkzeuge. Manche von uns erstellen ihre gern selbst, andere bevorzugen Werkzeuge aus 
	der Konserve (z.B. solche, die von jemandem für bestimmte Zwecke vorbereitet wurden).
	</para>

	<sect2>
	<title>Beispiel für ein &smb.conf;-Skript zum Hinzufügen von Gruppen</title>

		<para>
		<link linkend="smbgrpadd.sh">smbgrpadd.sh</link> ist ein Skript, um übereinstimmende Gruppennamen für die Nutzung durch das Samba-Gruppeninterface zu erstellen.
		</para>

<indexterm><primary>smbgrpadd.sh</primary></indexterm>
		<para>
<example id="smbgrpadd.sh">
	<title>smbgrpadd.sh</title>
<programlisting>

#!/bin/bash

# Fügt die Gruppe unter Nutzung des normalen groupadd-Systemwerkzeugs hinzu.
groupadd smbtmpgrp00

thegid=`cat /etc/group | grep smbtmpgrp00 | cut -d ":" -f3`

# Jetzt den Namen für unser MS Windows-Netzwerk passend ändern.
cp /etc/group /etc/group.bak
cat /etc/group.bak | sed "s/smbtmpgrp00/$1/g" > /etc/group

# Melde uns die GID zurück.
echo $thegid
exit 0
</programlisting>
</example>
</para>

		<para>
		Der &smb.conf;-Eintrag für obiges Skript kann etwas wie in 
		<link linkend="smbgrpadd">dem folgenden Beispiel</link> sein.
<smbconfexample id="smbgrpadd">
<title>Konfiguration von &smb.conf; für das Skript zum Gruppenhinzufügen.</title>
<smbconfsection>[global]</smbconfsection>
<member>...</member>
<smbconfoption><name>add group script</name><value>/Pfad_zum_Werkzeug/smbgrpadd.sh &quot;%g&quot;</value></smbconfoption>
<member>...</member>
</smbconfexample>
		</para>

	</sect2>
	
	<sect2>
	<title>Skript zum Konfigurieren von Gruppen-Mappings</title>

	<para>
		In unserem Beispiel haben wir eine UNIX/Linux-Gruppe namens <ntgroup>ntadmin</ntgroup> erzeugt.
		Unser Skript wird die zusätzlichen Gruppen <ntgroup>Orks</ntgroup>, <ntgroup>Elfen</ntgroup> 
		und <ntgroup>Gnome</ntgroup> anlegen.
		Es ist eine gute Idee, dieses Shellskript für eine spätere erneute Nutzung abzuspeichern, auch 
		für den Fall, dass Sie später Ihre
		Mapping-Datenbank einmal neu anlegen müssen.
		Aus praktischen Gründen entscheiden wir uns, dieses Skript als eine Datei namens 
		<filename>initGroups.sh</filename> zu speichern.
		Dieses Skript heißt in diesem Beispiel <link linkend="set-group-map">initGroups.sh</link>.
	</para>

<para>
<indexterm><primary>initGroups.sh</primary></indexterm>
<example id="set-group-map">
	<title>Skript zum Setzen von Gruppen-Mappings</title>
<programlisting>
#!/bin/bash

net groupmap modify ntgroup="Domänen Administratoren" unixgroup=ntadmin
net groupmap modify ntgroup="Domänen Benutzer" unixgroup=users
net groupmap modify ntgroup="Domänen Gäste" unixgroup=nobody

groupadd Orks
groupadd Elfen
groupadd Gnome

net groupmap add ntgroup="Orks"   unixgroup=Orks   type=d
net groupmap add ntgroup="Elfen"  unixgroup=Elfen  type=d
net groupmap add ntgroup="Gnome"  unixgroup=Gnome  type=d
</programlisting>
</example>
</para>

	<para>
	Natürlich wird vorausgesetzt, dass der Administrator dies für lokale Zwecke anpasst.
	Für Informationen zur Nutzung des Werkzeugs <command>net groupmap</command> 
	sehen Sie bitte in der Manpage nach.
	</para>

	</sect2>

</sect1>

<sect1>
<title>Gängige Fehler</title>

<para>
Zurzeit gibt es eine Menge kleiner Überraschungen für den unachtsamen Administrator. In gewisser Weise ist es 
erforderlich, dass jeder Schritt automatisierter Kontrollskripten sorgfältig manuell getestet wird,
bevor diese in der Praxis verwendet werden.
</para>

	<sect2>
	<title>Das Hinzufügen von Gruppen schlägt fehl</title>

		<para>
		Dies ist ein häufiges Problem, wenn <command>groupadd</command> direkt von dem 
		Samba-Interface-Skript
		für <smbconfoption><name>add group script</name></smbconfoption> 
		(Parameter in der Datei &smb.conf;) aufgerufen wurde.
		</para>

		<para>
		Der häufigste Grund für diesen Fehler ist der Versuch, ein MS Windows-Gruppenkonto hinzuzufügen, das
		entweder ein großgeschriebenes Zeichen und/oder ein Leerzeichen enthält.
		</para>

		<para>
		Es gibt drei mögliche Workarounds. Erstens: Benutzen Sie nur Gruppennamen, die mit den
		Einschränkungen des UNIX/Linux-Systemwerkzeugs <command>groupadd</command> zurechtkommen.
		Der zweite betrifft die Benutzung des Skripts, welches weiter oben in diesem Kapitel erwähnt wurde, und
		der dritte ist die Option, ein UNIX/Linux-Gruppenkonto manuell anzulegen, das zu dem 
		MS Windows-Gruppennamen passt; dann benutzen Sie den oben beschriebenen Ablauf, um
		diese Gruppe auf eine MS Windows-Gruppe zu mappen.
		</para>

	</sect2>

	<sect2>
	<title>Das Hinzufügen von MS Windows-Gruppen zu MS Windows-Gruppen schlägt fehl</title>

	<indexterm><primary>Gruppen</primary><secondary>verschachtelt</secondary></indexterm>

		<para>
		Samba-3 unterstützt keine verschachtelten Gruppen aus der MS Windows-Kontrollumgebung.
		</para>

	</sect2>

	<sect2>
	<title><emphasis>Domänen Benutzer</emphasis> zu der Gruppe <emphasis>Hauptbenutzer</emphasis> hinzufügen</title>

		<para><quote>
		Was muss ich machen, um Domänenbenutzer zu der Hauptbenutzer-Gruppe hinzuzufügen?
		</quote></para>

<indexterm><primary>Domänen-Benutzergruppe</primary></indexterm>

		<para>
		Die Hauptbenutzer-Gruppe ist eine Gruppe, die lokal auf jeder Windows 200x/XP Professional-Arbeitsstation vorhanden ist.
		Sie können die Domänen-Benutzergruppe nicht automatisch zu der Hauptbenutzer-Gruppe hinzufügen. Dazu müssen Sie sich auf jeder 
		Arbeitsstation als der lokale Arbeitsstations-<emphasis>Administrator</emphasis> 
		und anmelden und folgende Prozedur abarbeiten:
		</para>

		<procedure>
			<step><para>
			Klicken Sie auf <guimenu>Start -> Systemsteuerung -> Benutzer und Kennwörter</guimenu>.
			</para></step>

			<step><para>
			Klicken Sie auf die Registerkarte <guimenuitem>Erweitert</guimenuitem>.
			</para></step>

			<step><para>
			Klicken Sie auf den Button <guibutton>Erweitert</guibutton>.
			</para></step>

			<step><para>
			Klicken Sie auf <constant>Gruppen</constant>.
			</para></step>

			<step><para>
			Doppelklicken Sie auf <constant>Hauptbenutzer</constant>. Dies lässt das Feld zum Hinzufügen von Benutzern und Gruppen
			zu der lokalen Gruppe <constant>Hauptbenutzer</constant> erscheinen.
			</para></step>

			<step><para>
			Klicken Sie auf den Button <guibutton>Hinzufügen</guibutton>.
			</para></step>

			<step><para>
			Wählen Sie die Domäne aus, von der Sie die Gruppe <constant>Domänen Benutzer</constant> hinzufügen.
			</para></step>

			<step><para>
			Doppelklicken Sie auf die Gruppe <constant>Domänen Benutzer</constant>.
			</para></step>

			<step><para>
			Klicken Sie auf den Button <guibutton>Ok</guibutton>. Falls während dieses Prozesses eine 
			Anmeldebox erscheint, denken Sie bitte daran, die Anmeldung als
			<constant>Domäne\Benutzername</constant>
			durchzuführen. Für die Domäne <constant>MITTELERDE</constant> und den Benutzer <constant>root</constant> geben Sie beispielsweise
			<constant>MITTELERDE\root</constant> ein.
			</para></step>
		</procedure>
	</sect2>

</sect1>

</chapter>
